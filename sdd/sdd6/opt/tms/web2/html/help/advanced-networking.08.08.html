<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>QoS Overview</title>
    <link rel="StyleSheet" href="css/advanced-networking.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
  </head>
  <body onload="WWHUpdate();" onunload="WWHUnload();" onkeydown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onkeypress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onkeyup="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <a class="WebWorks_Breadcrumb_Link" href="advanced-networking.08.01.html#399945">Chapter 6	Configuring Network Integration Features</a> : <a class="WebWorks_Breadcrumb_Link" href="advanced-networking.08.07.html#399945">Applying QoS Policies</a> : QoS Overview</div>
    <hr align="left" />
    <blockquote>
      <div class="Heading2Topic"><a name="399945">QoS Overview</a></div>
      <div class="Body"><a name="400462">QoS is a reservation system for network traffic. In its most basic form, QoS allows organizations to allocate </a>scarce network resources across multiple traffic types of varying importance. Advanced QoS implementations allow organizations to accurately control their applications by the amount of bandwidth they have access to and by their sensitivity to delay.</div>
      <div class="Heading3"><a name="484063">QoS Enhancements by Version</a></div>
      <div class="Body"><a name="484115">This section lists new QoS features and enhancements by version.</a></div>
      <div class="Body"><a name="481870">RiOS v7.0.3 provides the following enhancements:</a></div>
      <li class="Bullet"><span style="font-weight: bold"><a name="482952">LAN bypass</a></span> - Virtual in-path network topologies where the LAN-bound traffic traverses the WAN interface might require that you configure the Steelhead appliance to bypass LAN-bound traffic so it is not subject to the maximum root bandwidth limit. Some deployment examples are WCCP or a WAN-side default gateway. The LAN bypass feature allows you to exempt certain subnets from QoS enforcement. For details, see <span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'advanced-networking.08.08.html#455433', '');" title="QoS Overview">Bypassing LAN Traffic</a></span>.</li>
      <li class="Bullet"><span style="font-weight: bold"><a name="482482">Bandwidth enforcement</a></span> - Issues a warning when you configure the sum of the bandwidth interfaces as a value greater than the model-specific QoS limits. The limits were introduced in RiOS v6.5.4 and v7.0.1. The warning appears when you save a configured bandwidth limit that exceeds the supported limit. If you receive the warning, adjust the sum of the configured QoS interface values to be lower or equal to the model-specific bandwidth limit and save the configuration.</li>
      <div class="Indent1"><a name="483531">Riverbed strongly recommends configuring the bandwidth at or below the appliance limit, as </a>problems arise when you exceed it. Upgrading a Steelhead appliance to RiOS v7.0.3 does not automatically fail when the configuration has a greater QoS bandwidth limit than the appliance supports. However, after the upgrade RiOS begins enforcing the bandwidth limits and disallows <span style="font-style: italic">any</span> QoS configuration changes. This could result in having to reconfigure all QoS policies to accommodate the bandwidth limit. </div>
      <div class="Body"><a name="399950">RiOS v7.0.1 provides the following features:</a></div>
      <li class="Bullet"><span style="font-weight: bold"><a name="399977">Inbound QoS</a></span> - Allocates bandwidth and prioritizes traffic flowing into the LAN network behind the Steelhead appliance. This provides the benefits of QoS for environments that cannot meet their QoS requirements with outbound QoS. Both the client-side and server-side Steelhead appliances must be running RiOS v7.0 or later. For details, see <span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupAdvNet_inboundQos.html#395995', '');" title="Configuring Inbound QoS">Configuring Inbound QoS</a></span>.</li>
      <li class="Bullet"><span class="Bold"><a name="533555">Steelhead CX</a></span><span style="font-weight: bold"> </span><span style="font-style: italic; font-weight: bold">xx</span><span style="font-weight: bold">55 series QoS limits</span> - Steelhead appliance models in the CX <span style="font-style: italic">xx</span>55 series enforce limits on QoS bandwidth and the maximum number of classes, rules, and sites. For details, see <span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'advanced-networking.08.08.html#533695', '');" title="QoS Overview">QoS CX xx55 Series Limits</a></span>.</li>
      <div class="Body"><a name="348306">RiOS v7.0 provides the following improvements to QoS marking:</a></div>
      <li class="Bullet"><a name="348357">More parameters to classify traffic into different marking values. These parameters allow you to </a>classify using header parameters such as VLAN, DSCP, and protocols, and AppFlow Engine (AFE) inspection. </li>
      <li class="Bullet"><a name="348364">Instead of using separate rules tables for DSCP marking, marking and shaping are combined in the </a>same table. You can specify a marking value in either a service class or in a rule. When you specify a marking value in a rule, that value takes precedence over the value in a class. </li>
      <li class="Bullet"><a name="348371">For optimized traffic, the server-side Steelhead appliance uses its local rules table for QoS marking </a>instead of relying on the rules configured on the client-side Steelhead appliance.</li>
      <div class="Body"><a name="349570">The QoS marking improvements require the following:</a></div>
      <li class="Bullet"><a name="350524">Both the client-side and server-side Steelhead appliances must be running RiOS v7.0 or later.</a></li>
      <li class="Bullet"><a name="348383">If you have configured QoS marking for a previous RiOS version, see </a><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'advanced-networking.08.08.html#350548', '');" title="QoS Overview">Upgrading a QoS Configuration</a></span>.</li>
      <li class="Bullet"><a name="349534">If you plan to configure QoS marking </a><span style="font-style: italic">without</span> QoS shaping, set the marking values in the application rules table. When you specify a marking value in a rule, that value takes precedence over the value in a class.</li>
      <li class="Bullet"><a name="349541">If you plan to configure QoS marking </a><span style="font-style: italic">and</span> QoS shaping, set the marking values in the service policies or classes.</li>
      <div class="Body"><a name="348313">RiOS v6.5 and later improves QoS with the following benefits:</a></div>
      <li class="Bullet"><span style="font-weight: bold"><a name="280208">Simplified setup</a></span> - A basic QoS configuration page streamlines setup for networks that require minimal configuration of network traffic.</li>
      <li class="Bullet"><span style="font-weight: bold"><a name="293545">AFE </a></span>- Allows advanced classification and shaping of network traffic. The Steelhead inspects classification rules for information within the TCP/UDP payload in addition to packet headers to distinguish between different traffic types. </li>
      <div class="Indent1"><a name="296969">With AFE, QoS can identify applications accurately and differentiate applications that use the same </a>port on the same server: for example, SharePoint and Microsoft Background Intelligent Transfer Service (BITS) can use port 80 on the same server. After an application is identified, you can place it into different classes for QoS enforcement. AFE identification is similar to deep packet inspection (DPI) because it identifies applications based on patterns. This approach allows you to more accurately identify modern applications than signature-based DPI methods by being aware of the more complex ways they communicate and the dependencies between multiple flows.</div>
      <div class="Indent1"><a name="296976">The QoS classifier in RiOS v6.5 and later accommodates multiple types of traffic monitoring, including </a>header-based and third-party protocol matching rules. A protocol matching rule contains a combination of header and Layer-7 information to identify applications accurately. By adjusting a global list of applications or class bandwidth allocations, you can use QoS to create endless combinations of Layer-7 applications. </div>
      <div class="Indent1"><a name="333401">To view the predefined global application list, go to:</a></div>
      <div class="Indent1"><a href="http://www.riverbed.com/us/products/technology/riverbed_classification_qos_engine.php" target="external_window" name="333403">http://www.riverbed.com/us/products/technology/riverbed_classification_qos_engine.php</a></div>
      <div class="Indent1"><a name="291978">In addition to supporting many well-known applications, you can use AFE to add signatures to </a>identify custom applications: for example, you can identify a new HTTP application based on a specific domain name or relative path.</div>
      <div class="Indent1"><a name="292331">You can also use AFE to classify encrypted applications, such as HTTPS. You do not need the public </a>and private key pair in order to use AppFlow Engine.</div>
      <div class="Indent1"><a name="292333">AFE works with both pass-through and optimized traffic and is available in basic outbound QoS, </a>advanced outbound QoS, and inbound QoS.</div>
      <li class="Bullet"><span style="font-weight: bold"><a name="280213">Port label handling</a></span> - Allows you to specify a port range for more efficient port handling.</li>
      <li class="Bullet"><span style="font-weight: bold"><a name="280214">Connection tracking for pass-through traffic</a></span> - Eliminates per-packet inspection of flow oriented traffic, thereby enhancing performance.</li>
      <li class="Bullet"><span style="font-weight: bold"><a name="280215">Rule hierarchy</a></span> - Allows you to increase the number of rules per site, up to 2000.</li>
      <li class="Bullet"><span style="font-weight: bold"><a name="280216">Site awareness</a></span> - Improves performance and scalability in multisite configurations (outbound QoS only).</li>
      <div class="Body"><a name="280221">QoS classes are based on traffic importance, bandwidth needs, and delay-sensitivity. You allocate network </a>resources to each of the classes. Traffic flows according to the network resources allocated to its class. </div>
      <div class="Body"><a name="280225">You configure QoS on client-side and server-side Steelhead appliances to control the prioritization of </a>different types of network traffic and to ensure that Steelhead appliances give certain network traffic (for example, Voice over IP (VoIP) higher priority over other network traffic. </div>
      <div class="Heading3"><a name="280229">Traffic Classification</a></div>
      <div class="Body"><a name="280231">QoS allows you to specify priorities for particular classes of traffic and properly distribute excess </a>bandwidth among classes. The QoS classification algorithm provides mechanisms for link sharing and priority services while decoupling delay and bandwidth allocation. </div>
      <div class="Body"><a name="280232">Many QoS implementations use some form of Packet Fair Queueing (PFQ), such as Weighted Fair </a>Queueing or Class-Based Weighted Fair Queueing. As long as high-bandwidth traffic requires a high priority (or vice-versa), PFQ systems perform adequately. However, problems arise for PFQ systems when the traffic mix includes high-priority, low-bandwidth traffic, or high-bandwidth traffic that does not require a high priority, particularly when both of these traffic types occur together. Features such as low-latency queueing (LLQ) attempt to address these concerns by introducing a separate system of strict priority queueing that is used for high-priority traffic. However, LLQ is not an effective way of handling bandwidth and latency trade-offs. LLQ is a separate queueing mechanism meant as a work-around for PFQ limitations.</div>
      <div class="Body"><a name="280237">The Riverbed QoS system is not based on PFQ, but rather on Hierarchical Fair Service Curve (HFSC). HFSC </a>delivers low latency to traffic without wasting bandwidth and delivers high bandwidth to delay-insensitive traffic without disrupting delay-sensitive traffic. The Riverbed QoS system achieves the benefits of LLQ without the complexity and potential configuration errors of a separate queueing mechanism. </div>
      <div class="Body"><a name="280244">The Steelhead appliance HFSC-based QoS enforcement system provides the flexibility needed to </a>simultaneously support varying degrees of delay requirements and bandwidth usage: for example, you can enforce a mix of high-priority, low-bandwidth traffic patterns (for example, SSH, Telnet, Citrix, RDP, and CRM systems) with lower priority, high-bandwidth traffic (for example, FTP, backup, and replication). RiOS QoS allows you to protect delay-sensitive traffic such as VoIP, as well as other delay-sensitive traffic such as RDP and Citrix. You can do this without having to reserve large amounts of bandwidth for their traffic classes.</div>
      <div class="Body"><a name="280245">QoS classification occurs during connection setup for optimized traffic, before optimization and </a>compression. QoS shaping and enforcement occurs after optimization and compression.</div>
      <div class="Body"><a name="280247">By design, QoS is applied to both pass-through and optimized traffic; however, you can choose to classify </a>either pass-through or optimized traffic. QoS is implemented in the operating system; it is not a part of the optimization service. When the optimization service is disabled, all the traffic is pass-through and is still shaped by QoS. </div>
      <div class="Heading2"><a name="533588">QoS </a><span style="font-style: normal">xx</span>50 Series Specifications</div>
      <div class="Body"><a name="533590">The maximum throughput and the number of QoS classes, sites, and rules you can configure on a Steelhead </a>appliance depends on the appliance model number, the traffic flow, and other RiOS features you enable. Riverbed recommends the following guidelines for optimal performance. </div>
      <table class="RegularTable" style="text-align: left; width: 467.7732pt" cellspacing="0" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 111.05352pt">
            <div class="CellHeading"><a name="536186">Steelhead</a> Appliance xx50 Model</div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 86.26824pt">
            <div class="CellHeading"><a name="536188">Maximum </a>Configurable  Root Bandwidth (Mbps)</div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 87.11712pt">
            <div class="CellHeading"><a name="536190">Maximum </a>Classes</div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 94.47984pt">
            <div class="CellHeading"><a name="536192">Maximum Rules</a></div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 88.85448pt">
            <div class="CellHeading"><a name="536194">Maximum Sites</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536196">250</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536198">4</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536200">150</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536202">150</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536204">15</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536206">550</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536208">10</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536210">250</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536212">250</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536214">25</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536216">1050</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536218">45</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536220">500</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536222">500</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536224">50</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536226">2050</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536228">100</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536230">1,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536232">1,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536234">100</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536236">5050</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536238">200</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536240">1,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536242">1,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536244">100</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536246">6050</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536248">310</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536250">2,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536252">2,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536254">100</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536256">7050</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536258">1,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536260">2,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536262">2,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="536264">100</a></div>
          </td>
        </tr>
      </table>
      <div class="Heading2"><a name="533695">QoS CX </a><span style="font-style: normal">xx</span>55 Series Limits</div>
      <div class="Body"><a name="533700">With the introduction of the Steelhead appliance CX </a><span style="font-style: italic">xx</span>55 series, QoS limits apply as shown in the following table. The QoS bandwidth limits are in place globally across all WAN interfaces and the primary interface.</div>
      <div class="Body"><a name="533704">Traffic that passes through a Steelhead CX but is not destined to the WAN is not subject to these QoS limits. </a>Examples of traffic that is not subject to QoS limits include routing updates, DHCP requests, default gateways on the WAN-side of the Steelhead CX that redirect traffic back to other LAN-side subnets. </div>
      <table class="RegularTable" style="text-align: left; width: 467.7732pt" cellspacing="0" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 111.05352pt">
            <div class="CellHeading"><a name="537533">Steelhead</a> Appliance CX Model</div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 86.26824pt">
            <div class="CellHeading"><a name="537535">Maximum </a>Configurable  Root Bandwidth (Mbps)</div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 87.11712pt">
            <div class="CellHeading"><a name="537537">Maximum </a>Classes</div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 94.47984pt">
            <div class="CellHeading"><a name="537539">Maximum Rules</a></div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 88.85448pt">
            <div class="CellHeading"><a name="537541">Maximum Sites</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody" style="margin-bottom: 5.5pt"><a name="537543">CX555 </a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody" style="margin-bottom: 5.5pt"><a name="537545">10</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="537547">250</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody" style="margin-bottom: 5.5pt"><a name="537549">250</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="537551">25</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody" style="margin-bottom: 5.5pt"><a name="537553">CX755 </a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody" style="margin-bottom: 5.5pt"><a name="537555">45</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="537557">500</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody" style="margin-bottom: 5.5pt"><a name="537559">500</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="537561">50</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="537563">CX1555 </a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody" style="margin-bottom: 5.5pt"><a name="537565">100</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="537567">1,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody" style="margin-bottom: 5.5pt"><a name="537569">1,000</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="537571">100</a></div>
          </td>
        </tr>
      </table>
      <div class="Heading2"><a name="402979">Basic or Advanced Outbound QoS</a></div>
      <div class="Body"><a name="280253">RiOS v6.5 and later provides two types of outbound QoS configurations: basic and advanced. The QoS </a>configuration you implement depends on how much classification and shaping your network traffic requires and whether you are migrating from a previous RiOS version or configuring QoS on a Steelhead for the first time.</div>
      <div class="Body"><a name="280260">Advanced outbound QoS supports different bandwidths for different interfaces; basic QoS does not, but </a>you can specify the remote site absolute bandwidth.</div>
      <div class="Body"><a name="280279">Use basic outbound QoS when you:</a></div>
      <li class="Bullet"><a name="280284">currently do not have RiOS QoS configured.</a></li>
      <li class="Bullet"><a name="280288">are currently using RiOS v6.1.x or earlier QoS but are willing to consolidate and reconfigure your </a>existing rules. The existing configuration is lost when you switch from advanced to basic QoS.</li>
      <li class="Bullet"><a name="280289">do not need more granular control and can use the default settings.</a></li>
      <div class="Body"><a name="280290">Use advanced outbound QoS when you:</a></div>
      <li class="Bullet"><a name="284914">are currently using RiOS v6.1.x or earlier QoS and do not want to reconfigure your existing rules. The </a>Steelhead preserves the configuration. </li>
      <li class="Bullet"><a name="284918">must use the MX-TCP queue. For details, see </a><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupAdvNet_qosClasses.html#395886', '');" title="Configuring Outbound QoS (Advanced)">Enabling MX-TCP Queue Policies (Advanced Outbound QoS only)</a></span>.</li>
      <li class="Bullet"><a name="291958">must set application priorities for Citrix ICA traffic (this requires packet-order queue).</a></li>
      <li class="Bullet"><a name="291959">have WAN links with different bandwidth (basic QoS assumes all links of the same size): for example, </a>you might have a 2-Mbps MPLS link with a 1-Mbps ADSL backup.</li>
      <div class="Heading3"><a name="350548">Upgrading a QoS Configuration</a></div>
      <div class="Body"><a name="350719">This section describes how upgrading the RiOS version affects your QoS configuration.</a></div>
      <div class="Heading4"><a name="350698">Upgrading to RiOS v7.0.x</a></div>
      <div class="Body"><a name="364457">In RiOS v7.0 and later, the DSCP or IP TOS marking only has local significance. This means you can set the </a>DSCP or IP TOS values on the server-side Steelhead appliance to values different to those set on the client-side Steelhead appliance.</div>
      <div class="Body"><a name="364485">When you upgrade to RiOS v7.0 or later, preexisting DSCP marking rules are preserved if there were no </a>other QoS configuration changes. QoS classification configuration with preexisting DSCP marking rules are not honored. RiOS v7.0 and later uses a new format for the QoS shaping configuration that does not allow adopting pre existing QoS classification. During the upgrade the system drops preexisting QoS classifications. </div>
      <div class="Body"><a name="350550">If you have not configured either basic or advanced outbound QoS in the previous version of RiOS:</a></div>
      <li class="Bullet"><a name="350777">The system migrates to advanced outbound QoS mode, sets the default class to DSCP reflect and the </a>QoS configuration to use the default QoS rule. </li>
      <li class="Bullet"><a name="351264">Because the server-side Steelhead appliance in RiOS 7.0 and later uses its local rules table for QoS </a>marking instead of relying on the rules configured on the client-side Steelhead appliance, both the client-side and server-side Steelhead appliances must be running 7.0 or later.</li>
      <div class="Body"><a name="364403">If you have configured either basic or advanced outbound QoS in a previous version of RiOS, the system </a>deletes any marking configuration upon upgrade. RiOS saves the marking configuration in a readable format to the log file. If you must reconfigure, you can retrieve the old rules from the log files. You can retrieve the log file from the Steelhead appliance by using SCP; for example</div>
      <div class="Code"><a name="350846">SCP &lt;Steelhead_IP-address:/var/log/qos_old_mark_cfg_log.txt ./)</a></div>
      <div class="Body"><a name="351309">RiOS updates a preexisting QoS configuration as follows:</a></div>
      <li class="Bullet"><a name="350558">RiOS adds the DSCP reflect value to all classes within all profiles.</a></li>
      <li class="Bullet"><a name="350559">RiOS adds the DSCP reflect value to all class instances. </a></li>
      <li class="Bullet"><a name="350560">RiOS adds the DSCP value inherits the value from the service class for all global applications. </a></li>
      <li class="Bullet"><a name="350931">RiOS adds the DSCP value 254 to all site filter rules.</a></li>
      <div class="Heading4"><a name="350655">Upgrading to RiOS v6.5.x</a></div>
      <div class="Body"><a name="350631">After upgrading a Steelhead to RiOS v6.5.</a><span style="font-style: italic">x</span>, the default is:</div>
      <li class="Bullet"><a name="350635">Basic outbound QoS on new and upgraded Steelheads that do not have a QoS configuration.</a></li>
      <li class="Bullet"><a name="350642">Advanced outbound QoS on Steelheads that have a existing QoS configuration. The Steelhead </a>preserves the configuration.</li>
      <div class="Heading2"><a name="284919">QoS Classes</a></div>
      <div class="Body"><a name="280299">QoS classes set priorities and bandwidths. Basic outbound QoS comes with six predefined classes, and you </a>cannot add or delete classes. In advanced outbound QoS and inbound QoS, you can create multiple QoS classes. There is no requirement that QoS classes represent applications, traffic to remote sites, or any other particular aggregation. </div>
      <div class="Body"><a name="280303">The QoS classes that are always present on the Steelhead appliance in advanced outbound QoS are:</a></div>
      <li class="Bullet"><span style="font-weight: bold"><a name="280306">Root class</a></span><span style="font-size: 9.0pt"> - </span>The root class is used to constrain the total outbound rate of traffic leaving the Steelhead appliance to the configured, per-link WAN bandwidth. This class is not configured directly, but is created when you enable QoS shaping and enforcement on the Steelhead appliance. </li>
      <li class="Bullet"><span style="font-weight: bold"><a name="280312">Built-in default class</a></span><span style="font-size: 9.0pt"> - </span>The QoS scheduler applies the built-in default class constraints and parameters on traffic not placed in a class by the configured QoS rules.</li>
      <div class="Body"><a name="280313">QoS classes are configured in one of two different modes: </a><span style="font-style: italic">flat</span> or <span style="font-style: italic">hierarchical</span>. The difference between the two modes primarily consists of how QoS classes are created. </div>
      <div class="Note">
        <span class="Bold">Note: </span><a name="280317">For details on QoS classes, see the </a><span class="book_title">Riverbed Deployment Guide</span>.</div>
      <div class="Heading3"><a name="280319">Hierarchical Mode (Advanced Outbound QoS)</a></div>
      <div class="Body"><a name="280320">In hierarchical mode, you create QoS classes as children of QoS classes other than the root class. This allows </a>you to create overall parameters for a certain traffic type, and specify parameters for subtypes of that traffic. There is no enforced limit to the number of QoS class levels you can create.</div>
      <div class="Body"><a name="280321">In hierarchical mode, the following relationships exist between QoS classes:</a></div>
      <li class="Bullet"><span style="font-weight: bold"><a name="280323">Sibling classes</a></span><span style="font-size: 9.0pt"> - </span>Classes that share the same parent class.</li>
      <li class="Bullet"><span style="font-weight: bold"><a name="280325">Leaf classes</a></span><span style="font-size: 9.0pt"> - </span>Classes at the bottom of the class hierarchy.</li>
      <li class="Bullet"><span style="font-weight: bold"><a name="280327">Inner classes</a></span><span style="font-size: 9.0pt"> - </span>Classes that are neither the root class nor leaf classes.</li>
      <div class="Body"><a name="280328">In hierarchical mode, QoS rules can only specify leaf classes as targets for traffic. </a></div>
      <div class="Body"><a name="280332">Riverbed QoS controls the traffic of hierarchical QoS classes in the following manner:</a></div>
      <li class="Bullet"><a name="280333">QoS rules assign active traffic to leaf classes.</a></li>
      <li class="Bullet"><a name="280334">The QoS scheduler:</a></li>
      <li class="BulletSubBullet2"><a name="280335">applies active leaf class parameters to the traffic.</a></li>
      <li class="BulletSubBullet2"><a name="280336">applies parameters to inner classes that have active leaf class children. </a></li>
      <div class="Heading3"><a name="280337">Flat Mode</a></div>
      <div class="Body"><a name="280338">In flat mode, all of the QoS classes you create must have the root class as their parent. Accordingly, all of the </a>QoS classes you create are siblings. </div>
      <div class="Body"><a name="401185">Basic outbound and inbound QoS always use flat mode. Advanced outbound QoS can use either flat or </a>hierarchical mode.</div>
      <div class="Body"><a name="280339">The QoS scheduler treats QoS classes in flat mode the same way that it does in hierarchical mode. However, </a>only a single class level is defined. QoS rules place active traffic into the leaf classes. Each active class has their own QoS rule parameters which the QoS scheduler applies to traffic.</div>
      <div class="Note">
        <span class="Bold">Note: </span><a name="280346">You can use the CMC to enable QoS and to configure and apply QoS policies centrally to Steelhead appliances. </a>For details, see the <span class="book_title">Steelhead Central Management Console User&#8217;s Guide</span> and the <span class="book_title">Riverbed Deployment Guide</span>.</div>
      <div class="Heading3"><a name="280354">Selecting an Outbound QoS Enforcement System</a></div>
      <div class="Body"><a name="280355">Selecting the appropriate QoS enforcement system depends on the location of WAN bottlenecks for traffic </a>leaving the site. </div>
      <div class="Body"><a name="280356">Use the following guidelines when implementing advanced outbound QoS:</a></div>
      <li class="Bullet"><a name="280357">A site that acts as a data server for other locations, such as a data center or regional hub, typically uses </a>hierarchical mode. The first level of classes represents remote sites, and those remote site classes have child classes that either represent application types, or are indirectly connected remote sites. </li>
      <li class="Bullet"><a name="280358">A site that typically receives data from other locations, such as a branch site, typically uses flat mode. </a>The classes represent different application types.</li>
      <div class="Body"><a name="280359">As an example, suppose you have a network with ten locations, and you want to choose the correct mode </a>for site 1. Traffic from site 1 normally goes to two other sites: sites 9 and 10. If the WAN links at sites 9 and 10 are at a higher bandwidth than the link at site 1, the WAN bottleneck rate for site 1 is always the link speed for site 1. In this case, you can use flat mode to enforce outbound QoS at site 1, because the bottleneck that needs to be managed is the link at site 1. In flat mode, the parent class for all created classes is the root class that represents the WAN link at site 1.</div>
      <div class="Body"><a name="455416">In the same network, site 10 sends traffic to sites 1 through 8. Sites 1 through 8 have slower bandwidth links </a>than site 10. Because the traffic from site 10 faces multiple WAN bottlenecks (one at each remote site), you configure hierarchical mode for site 10.</div>
      <div class="Note">
        <span class="Bold">Note: </span><a name="455430">For details on configuring QoS for a branch office and data center, see the </a><span class="book_title">Riverbed Deployment Guide</span>.</div>
      <div class="Heading3"><a name="455433">Bypassing LAN Traffic</a></div>
      <div class="Body"><a name="533865">RiOS v7.0.1 and later imposes a maximum limit on the configurable root bandwidth for the WAN interface. </a>The hardware platform determines the maximum limit. The bandwidth limit prevents you from configuring WAN interfaces with a bandwidth rate that exceeds the hardware model limits. For details, see <span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'advanced-networking.08.08.html#533695', '');" title="QoS Overview">QoS CX xx55 Series Limits</a></span>.</div>
      <div class="Body"><a name="455451">Certain virtual in-path network topologies where the LAN-bound traffic traverses the WAN interface might </a>require that the Steelhead appliance bypass LAN-bound traffic so that it is not included in the rate limit determined by the maximum root bandwidth. Some deployment examples are WCCP or a WAN-side default gateway.</div>
      <div class="Body"><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'advanced-networking.08.08.html#455437', '');" title="QoS Overview" name="455453">Figure&nbsp;6&#8209;1</a></span> illustrates a topology where the default LAN gateway or router is accessible over the WAN interface of the Steelhead appliance. If there are two clients in the local subnet, traffic between the two clients is routable after reaching the LAN gateway. As a result, this traffic traverses the WAN interface of the Steelhead appliance.</div>
      <div class="FigCap">
        <span class="Bold_Helvetica">Figure&nbsp;6&#8209;1. </span><a name="455437">LAN Gateway Accessible over the WAN Interface of the Steelhead Appliance</a></div>
      <div class="Heading4" style="color: #000000; font-style: normal; font-variant: normal; font-weight: bold; margin-top: 14.0pt; text-transform: none; vertical-align: baseline"><a name="456553">&nbsp;</a></div>
      <div class="Heading4" style="color: #000000; font-style: normal; font-variant: normal; font-weight: bold; margin-top: 14.0pt; text-transform: none; vertical-align: baseline"><span style="color: #000000; font-family: Helvetica; font-size: 10.0pt; font-style: normal; font-variant: normal; font-weight: bold; text-transform: none; vertical-align: baseline"><a name="458646">Local Subnet ---- LAN ---- Steelhead --- WAN --- LAN Gateway ---------- WAN ------ Remote Subnets</a></span></div>
      <div class="Body"><a name="455514">&nbsp;</a></div>
      <div class="Body"><a name="458649">In a QoS configuration for this topology, suppose you have several QoS classes created and the root class is </a>configured with the WAN interface rate. The remainder of the classes use a percentage of the root class. In this scenario, the LAN traffic will be rate limited because it is classified into one of the classes under the root class. </div>
      <div class="Body"><a name="455311">You can use the LAN bypass feature in RiOS v7.0.3 to exempt certain subnets from QoS enforcement, </a>bypassing the rate limit. The LAN bypass feature only works when enabled on outbound QoS. </div>
      <div class="HeadingProcedure"></div>
      <div class="Step_outer" style="margin-left: 0pt"></div>
      <div class="HeadingProcedure"><a name="457650">To filter the LAN traffic from WAN traffic</a></div>
      <div class="Step1_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step1_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step1_inner"><a name="457652">Choose Configure &gt; Networking &gt; Subnet Side Rules. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="457654">Click </a><span style="font-weight: bold">Add a Subnet Side Rule</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="457656">Select Start, End, or a rule number from the drop-down list.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="457658">Specify the client-side Steelhead appliance subnet using the format &lt;IP address&gt;/&lt;subnet mask&gt;.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="457660">Select Subnet address is on the LAN side of the appliance.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="457643">Click </a><span style="font-weight: bold">Add</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Note">
        <span class="Bold">Note: </span><a name="457762">The Steelhead appliance processes the subnet side LAN rules before the QoS outbound rules.</a></div>
      <div class="Note">
        <span class="Bold">Note: </span><a name="457753">In virtual-in-path deployment, using subnet side rules is the same for QoS, </a>RSP, and NetFlow. In an in-path deployment RSP and NetFlow discard the subnet side rules. </div>
      <div class="Heading3"><a name="280363">QoS Classification for the FTP Data Channel </a></div>
      <div class="Body"><a name="537235">When configuring QoS classification for FTP, the QoS rules differ depending on whether the FTP data </a>channel is using<span style="font-style: italic"> active</span> or <span style="font-style: italic">passive</span> FTP. Active versus passive FTP determines whether the FTP client or the FTP server select the port connection for use with the data channel, which has implications for QoS classification.</div>
      <div class="Body"><a name="537239">The AppFlow engine in RiOS v6.5 and later does not support passive FTP. Because passive FTP uses </a>random high TCP-port numbers to set up its data channel from the FTP server to the FTP client, the FTP data traffic cannot be classified on the TCP port numbers. To classify passive FTP traffic, you can add an application rule where the application is FTP and that matches on the FTP servers IP address.</div>
      <div class="Heading4"><a name="537240">Active FTP Classification</a></div>
      <div class="Body"><a name="537241">With active FTP, the FTP client logs in and enters the PORT command, informing the server which port it </a>must use to connect to the client for the FTP data channel. Next, the FTP server initiates the connection towards the client. From a TCP perspective, the server and the client swap roles. The FTP server becomes the client because it sends the SYN packet, and the FTP client becomes the server because it receives the SYN packet.</div>
      <div class="Body"><a name="537242">Although not defined in the RFC, most FTP servers use source port 20 for the active FTP data channel. </a></div>
      <div class="Body"><a name="537246">For active FTP, configure a QoS rule on the server-side Steelhead appliance to match source port 20. On the </a>client-side Steelhead appliance, configure a QoS rule to match destination port 20.</div>
      <div class="Body"><a name="537250">You can also use AFE to classify active FTP data.</a></div>
      <div class="Heading4"><a name="537251">Passive FTP Classification</a></div>
      <div class="Body"><a name="537252">With passive FTP, the FTP client initiates both connections to the server. First, it requests passive mode by </a>entering the PASV command after logging in. Next, it requests a port number for use with the data channel from the FTP server. The server agrees to this mode, selects a random port number, and returns it to the client. Once the client has this information, it initiates a new TCP connection for the data channel to the server-assigned port. Unlike active FTP, there is no role swapping and the FTP client initiates the SYN packet for the data channel. </div>
      <div class="Body"><a name="537253">The FTP client receives a random port number from the FTP server.</a><span style="font-family: &quot;Times New Roman&quot;"> </span>Because the FTP server cannot return a consistent port number to use with the FTP data channel, RiOS does not support QoS Classification for passive FTP in versions earlier than RiOS v4.1.8, v5.0.6, or v5.5.1. Later RiOS releases support passive FTP and the QoS Classification configuration for passive FTP is the same as active FTP.</div>
      <div class="Body"><a name="537265">When configuring QoS Classification for passive FTP, port 20 on both the server and client-side Steelhead </a>appliances means the port number used by the data channel for passive FTP, as opposed to the literal meaning of source or destination port 20.</div>
      <div class="Note">
        <span class="Bold">Note: </span><a name="537270">The Steelhead appliance must intercept the FTP control channel (port 21), regardless of whether the FTP data </a>channel is using active or passive FTP.</div>
      <div class="Body"><a name="357006">The AppFlow engine does not support passive FTP. Because passive FTP uses random high TCP-port </a>numbers to set up its data channel from the FTP server to the FTP client, the FTP data traffic cannot be classified on the TCP port numbers. To classify passive FTP traffic, you can add an application rule in which the application is FTP and matches the IP address of the FTP server.</div>
      <div class="Heading3"><a name="280425">QoS Classification for Citrix Traffic </a></div>
      <div class="Body"><a name="280429">RiOS v6.0 and later provides a way to classify Citrix traffic using QoS to differentiate between different </a>traffic types within a Citrix session. QoS classification for Citrix traffic is beneficial in mixed-use environments where Citrix users perform printing and use drive-mapping features. Using QoS to classify Citrix traffic in a mixed-use environment provides optimal network performance for end users. Note that if the Citrix sessions in your environment carry only interactive traffic, you can use basic outbound QoS.</div>
      <div class="Body"><a name="280430">Citrix QoS classification provides support for </a>Presentation Server v4.5, XenApp v5.0 and v6.0, and v10.x, v11.x, and v12.x clients.</div>
      <div class="Body"><a name="280434">The essential RiOS capabilities that ensure optimal delivery of Citrix traffic over the network are: </a></div>
      <li class="Bullet"><span style="font-weight: bold"><a name="280435">Latency priority</a></span><span style="font-size: 9.0pt"> - </span>The Citrix traffic application priority affects traffic latency. This allows you to assign interactive traffic a higher priority than print or drive-mapping traffic. A typical application priority for interactive Citrix sessions, such as screen updates, is real-time or interactive. Keep in mind that priority is relative to other classes in your QoS configuration. You must use advanced outbound QoS. </li>
      <li class="Bullet"><span style="font-weight: bold"><a name="280436">Bandwidth allocation</a></span> (also known as traffic shaping)<span style="font-size: 9.0pt"> - </span>When configuring QoS for Citrix traffic, it is important to allocate the correct amount of bandwidth for each QoS traffic class. The amount you specify reserves a predetermined amount of bandwidth for each traffic class. Bandwidth allocation is important for ensuring that a given class of traffic cannot consume more bandwidth than it is allowed. It is also important to ensure that a given class of traffic has a minimum amount of bandwidth available for delivery of data through the network.</li>
      <div class="Body"><a name="280442">RiOS v6.5 and later provides a default rule for Citrix ICA traffic. You can simply use the default rule or edit </a>it to suit your configuration in either basic outbound or advanced outbound QoS. </div>
      <div class="Body"><a name="287443">The default ports for the Citrix service are 1494 (native ICA traffic) and 2598 (session reliability). To use </a>session reliability, you must enable Citrix optimization on the Steelhead appliance in order to classify the traffic correctly. You can enable and modify Citrix optimization settings in the Configure &gt; Optimization &gt; Citrix page. For details, see <span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceProtocolsICA.html#333018', '');" title="Configuring Citrix Optimization">Configuring Citrix Optimization</a></span>. </div>
      <div class="Body"><a name="295792">You can use session reliability with optimized traffic only. Session reliability with RiOS QoS does not </a>support pass-through traffic. For details about disabling session reliability, go to<br /><a href="http://support.citrix.com/proddocs/index.jsp?topic=/xenapp5fp-w2k8/ps-sessions-sess-rel.html" target="external_window">http://support.citrix.com/proddocs/index.jsp?topic=/xenapp5fp-w2k8/ps-sessions-sess-rel.html</a></div>
      <div class="Important">
        <span class="Bold">Important: </span><a name="280451">If you upgrade from a previous RiOS version with an existing Citrix QoS configuration, the upgrade </a>automatically combines the five preexisting Citrix rules into one.</div>
      <div class="Note">
        <span class="Bold">Note: </span><a name="434051">For QoS configuration examples, see the </a><span class="book_title">Riverbed Deployment Guide</span>.</div>
      <div class="Body"><a name="448352">&nbsp;</a></div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <hr align="left" />
    <table align="right">
      <tr>
        <td class="WebWorks_Company_Logo_Bottom">
          <a href="http://riverbed.com" target="external_window"><img src="riverbed_logo_without_tagline.jpg" border="0" /></a>
        </td>
      </tr>
    </table>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>