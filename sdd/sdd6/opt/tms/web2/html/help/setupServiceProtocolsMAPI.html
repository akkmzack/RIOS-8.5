<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Configuring MAPI Optimization</title>
    <link rel="StyleSheet" href="css/optimization.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
  </head>
  <body onload="WWHUpdate();" onunload="WWHUnload();" onkeydown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onkeypress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onkeyup="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <a class="WebWorks_Breadcrumb_Link" href="optimization.05.01.html#252789">Chapter 3	Configuring Optimization Features</a> : Configuring MAPI Optimization</div>
    <hr align="left" />
    <blockquote>
      <div class="Heading1Topic"><a name="252789">Configuring MAPI Optimization</a></div>
      <div class="Body"><a name="252790">You can display and modify MAPI optimization settings in the Configure &gt; Optimization &gt; MAPI page. </a></div>
      <div class="Body"><a name="252791">MAPI optimization does not require a separate license and is enabled by default. </a></div>
      <div class="Body"><a name="252798">RiOS v6.0 and later uses the Steelhead secure inner channel to ensure all MAPI traffic sent between the </a>client-side and the server-side Steelhead appliances is secure. You must set the secure peering traffic type to All. For details, see <span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceProtocolsSSLPeering.html#222222', '');" title="Configuring Secure Peers">Enabling Secure Peers</a></span>.</div>
      <div class="Body"><a name="341063">You must enable MAPI optimization on all Steelhead appliances optimizing MAPI in your network, not just </a>the client-side Steelhead appliance.</div>
      <div class="HeadingProcedure"><a name="252803">To configure MAPI optimization features</a></div>
      <div class="Step1_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step1_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step1_inner"><a name="252807">Set up secure peering between the client-side and server-side Steelhead appliances and enable inner </a>channel SSL with secure protocols. For details, see <span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceProtocolsSSLPeering.html#237300', '');" title="Configuring Secure Peers">Configuring Secure Peers</a></span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="252811">Choose Configure &gt; Optimization &gt; MAPI to display the MAPI page.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="252816">Under Settings, complete the configuration as described in the following table. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <table class="RegularTable" style="text-align: left; width: 467.87616pt" cellspacing="0" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #ADBDF2; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 100.68768pt">
            <div class="CellHeading"><a name="505407">Control</a></div>
          </td>
          <td style="background-color: #ADBDF2; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 367.18848pt">
            <div class="CellHeading"><a name="505409">Description</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505411">Enable MAPI </a>Exchange Optimization</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505413">Enables the fundamental component of the MAPI optimization module, which includes </a>optimization for Read, Write (Receive, Send), and Sync operations. </div>
            <div class="CellBody"><a name="505414">By default, MAPI Exchange optimization is enabled. </a></div>
            <div class="CellBody"><a name="505415">Only clear this check box to disable MAPI optimization. Typically, you disable MAPI </a>optimization to troubleshoot problems with the system: for example, if you are experiencing problems with Outlook clients connecting with Exchange, you can disable MAPI latency acceleration (while continuing to optimize with SDR for MAPI).</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505417">Exchange Port</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505419">Specify the MAPI Exchange port for optimization. Typically, you do not need to modify </a>the default value, 7830. </div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505421">Enable Outlook </a>Anywhere Optimization</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505424">Enables Outlook Anywhere latency optimization. Outlook Anywhere is a feature of </a>Microsoft Exchange Server 2003, 2007, and 2010 that allows Microsoft Office Outlook 2003, 2007, and 2010 clients to connect to their Exchange servers over the Internet using the Microsoft RPC tunneling protocol. Outlook Anywhere allows for a VPN-less connection as the MAPI RPC protocol is tunneled over HTTP or HTTPS. RPC over HTTP can transport regular or encrypted MAPI. If you use encrypted MAPI, the server-side Steelhead appliance must be a member of the Windows domain.</div>
            <div class="CellBody"><a name="505437">Enable this feature on the client-side and server-side Steelheads. Both Steelheads must be </a>running RiOS v6.5 or later.</div>
            <div class="CellBody"><a name="505441">By default, this feature is disabled.</a></div>
            <div class="CellBody"><a name="505442">To use this feature, you must also enable HTTP Optimization on the client-side and server-</a>side Steelheads (HTTP optimization is enabled by default). </div>
            <div class="CellBody"><a name="505447">If you are using Outlook Anywhere over HTTPS, you must enable SSL and the IIS </a>certificate must be installed on the server-side Steelhead:</div>
            <li class="CellBullet"><a name="505451">When using HTTP, Outlook can only use NTLM proxy authentication.</a></li>
            <li class="CellBullet"><a name="505452">When using HTTPS, Outlook can use NTLM or Basic proxy authentication.</a></li>
            <li class="CellBullet"><a name="505453">When using encrypted MAPI with HTTP or HTTPS, you must enable and configure </a>encrypted MAPI in addition to this feature. </li>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="505454">Outlook Anywhere optimized connections cannot start MAPI prepopulation.</a></div>
            <div class="CellBody"><a name="505455">After you apply your settings, you can verify that the connections appear in the Current </a>Connections report as a MAPI-OA or an eMAPI-OA (encrypted MAPI) application. The Outlook Anywhere connection entries appear in the system log with an RPCH prefix. </div>
            <div class="CellImportant">
              <span class="Bold">Important: </span><a name="505461">Outlook Anywhere creates twice as many connections on the Steelhead than </a>regular MAPI. This results in the Steelhead entering admission control twice as fast with Outlook Anywhere than with regular MAPI. For details, see Appendix B - Steelhead Appliance MIB.</div>
            <div class="CellBody"><a name="505471">For details and troubleshooting information, see the </a><span class="book_title">Riverbed Deployment Guide</span>.</div>
            <div class="CellBody"><a name="505472">For details about enabling Outlook Anywhere, see</a><br /><a href="http://technet.microsoft.com/en-us/library/bb123513(EXCHG.80).aspx" target="external_window">http://technet.microsoft.com/en-us/library/bb123513(EXCHG.80).aspx </a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505476">Auto-Detect Outlook </a>Anywhere Connections</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505480">Automatically detects the RPC over HTTPS protocol used by Outlook Anywhere. This </a>feature is dimmed and unavailable until you enable Outlook Anywhere optimization. By default, these options are enabled. </div>
            <div class="CellBody"><a name="505481">You can enable automatic detection of RPC over HTTPS using this option or you can set </a>in-path rules. Auto-detect is best for simple Steelhead configurations with only a single Steelhead at each site and when the IIS server is also handling Web sites. </div>
            <div class="CellBody"><a name="505490">If the IIS server is only used as RPC Proxy, and for configurations with asymmetric </a>routing, connection forwarding or Interceptor installations, add in-path rules that identify the RPC Proxy server IP addresses and select the Outlook Anywhere latency optimization policy. After adding the in-path rule, disable the auto-detect option. </div>
            <div class="CellBody"><a name="505491">On an Interceptor, add load-balancing rules to direct traffic for RPC Proxy to the same </a>Steelhead appliance. </div>
            <div class="CellBody"><a name="505496">In-path rules interact with auto-detect as follows: </a></div>
            <li class="CellBullet"><a name="505500">When auto-detect is enabled and the in-path rule does not match, RiOS optimizes </a>Outlook Anywhere if it detects the RPC over HTTPS protocol.</li>
            <li class="CellBullet"><a name="505504">When auto-detect is not enabled and the in-path rule does not match, RiOS does not </a>optimize Outlook Anywhere. </li>
            <li class="CellBullet"><a name="505508">When auto-detect is enabled and the in-path rule matches with HTTP only, RiOS does </a>not optimize Outlook Anywhere (even if it detects the RPC over HTTPS protocol). </li>
            <li class="CellBullet"><a name="505509">When auto-detect is not enabled and the in-path rule does not match with HTTP only, </a>RiOS does not optimize Outlook Anywhere. </li>
            <li class="CellBullet"><a name="505513">When auto-detect is enabled and the in-path rule matches with an Outlook Anywhere </a>latency optimization policy, RiOS optimizes Outlook Anywhere (even if it does not detect the RPC over HTTPS protocol). </li>
            <li class="CellBullet"><a name="505517">When auto-detect is not enabled and the in-path rule matches with Outlook Anywhere, </a>RiOS optimizes Outlook Anywhere. </li>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505522">Enable Encrypted </a>Optimization</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505526">Enables encrypted MAPI RPC traffic optimization between Outlook and Exchange. By </a>default, this option is disabled. </div>
            <div class="CellBody"><a name="505528">The basic steps to enable encrypted optimization are:</a></div>
            <div class="CellBody"><a name="505531">1. Choose Configure &gt; Networking &gt; Windows Domain and join the server-side Steelhead </a>appliance to the same Windows Domain that the Exchange server belongs to and operates as a member server. An adjacent domain can be used (through cross-domain support) if the Steelhead appliance is running RiOS v6.1 or later. It is not necessary to join the client-side Steelhead appliance to the domain.</div>
            <div class="CellBody"><a name="505542">2. Verify that Outlook is encrypting traffic.</a></div>
            <div class="CellBody"><a name="505546">3. Enable this option on all Steelheads involved in optimizing MAPI encrypted traffic. </a></div>
            <div class="CellBody"><a name="505551">4. RiOS v7.0 supports both NTLM and Kerberos authentication. To use Kerberos </a>authentication, select Enable Kerberos Authentication support on both the client-side and server-side Steelhead appliances. Both Steelhead appliances must be running RiOS v7.0. Windows 7 clients must not be configured to use NTLM only.</div>
            <div class="CellBody"><a name="505564">In RiOS v7.0, Windows 7 MAPI clients must use Delegation mode unless you join the </a>server-side Steelhead appliance as an RODC. Transparent mode is the default in RiOS v6.5 and later. Use Transparent mode for all other clients and for Windows 7 MAPI clients when the server-side Steelhead appliance is joined as an RODC. </div>
            <div class="CellBody"><a name="505577">5. Restart the service on all Steelheads that have this option enabled. </a></div>
            <div class="CellImportant">
              <span class="Bold">Important: </span><a name="505582">Windows 7 clients running RiOS 6.1.x with MAPI encryption enabled cannot </a>connect to a Microsoft Exchange <span style="font-style: italic">cluster</span> even after auto or manual delegation mode is configured. You must configure the Active Directory delegate user with the Exchange Cluster node service exchangeMDB. By default the Exchange 2003 and 2007 cluster nodes do not have exchangeMDB service and hence these must be defined manually in a Domain Controller. If your configuration includes an Exchange cluster working with encrypted MAPI optimization, you must use manual delegation mode and perform the steps in this Knowledge Base article:</div>
            <div class="Body" style="color: #000000; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 5.0pt; margin-top: 5.0pt; text-transform: none; vertical-align: baseline"><span style="color: #000000; font-family: &quot;Microsoft Sans Serif&quot;; font-size: 9.0pt; font-style: normal; font-variant: normal; font-weight: normal; text-transform: none; vertical-align: baseline"><a href="https://support.riverbed.com/kb/solution.htm?Id=501A0000000Pw1d" target="external_window" name="505585">https://support.riverbed.com/kb/solution.htm?Id=501A0000000Pw1d</a></span></div>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="505592">Both the server-side and client-side Steelheads must be running RiOS v5.5.x or later.</a></div>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="505593">When this option is enabled</a><span style="font-weight: bold"> </span>and Enable MAPI Exchange 2007 Acceleration is disabled on either Steelhead appliance, MAPI Exchange 2007 acceleration remains in effect for unencrypted connections. </div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505598">NTLM Transparent </a>Mode</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505600">Provides encrypted MAPI with transparent NTLM authentication. By default, this setting </a>is enabled with encrypted MAPI optimization.</div>
            <div class="CellBody"><a name="505601">Transparent mode supports all Windows servers, including Windows 2008 R2 (assuming </a>they are not in domains with NTLM disabled). Transparent mode does <span style="font-style: italic">not</span> support Windows 7 clients or Windows 2008 R2 domains with NTLM disabled. Windows 7 clients must use Delegation mode.</div>
            <div class="CellBody"><a name="505605">In RiOS v6.1 and later, transparent mode includes support for trusted domains, wherein </a>users are joined to a different domain from the Exchange server being accessed. </div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505607">NTLM Delegation </a>Mode</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505609">Provides encrypted MAPI optimization using the Kerberos delegation facility. Select this </a>mode if you are encrypting MAPI traffic for Windows 7 or earlier client versions. The server-side Steelhead appliance must be running RiOS v6.1 or later. </div>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="505616">CIFS SMB Signing and Encrypted MAPI optimization share the delegate user </a>account. If you enable Delegation mode for both features, the delegate user account must have delegation privileges for both features as well. If you are upgrading from RiOS v6.0, a delegation account might already be in place for CIFS SMB Signing. </div>
            <div class="CellBody"><a name="505623">In RiOS v6.1 and later, Delegation mode includes support for trusted domains, wherein </a>users are joined to a different domain from the filer being accessed. </div>
            <div class="CellBody"><a name="505624">Delegation mode requires additional configuration. To configure Delegation mode, choose </a>Configure &gt; Optimization &gt; Windows Domain Authentication.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505626">Enable Kerberos </a>Authentication Support</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505629">Provides encrypted MAPI optimization with end-to-end authentication using Kerberos. </a>The server-side Steelhead appliance uses Kerberos to authenticate users.</div>
            <div class="CellBody"><a name="505639">The server-side Steelhead appliance must be running RiOS v7.0.x.</a></div>
            <div class="CellBody"><a name="505643">In addition to enabling this feature, you must also join the server-side Steelhead appliance </a>to a Windows Domain and add replication users on the Configure &gt; Optimization &gt; Windows Domain Authentication page. </div>
            <div class="CellBody"><a name="505647">The server-side Steelhead appliance must be joined to the same Windows Domain that the </a>Exchange server belongs to and operates as a member server. </div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505649">Enable Transparent </a>Prepopulation</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505651">Enables a mechanism for sustaining Microsoft Exchange MAPI connections between the </a>client and server even after the Outlook client has shut down. This allows email data to be delivered between the Exchange server and the client-side Steelhead appliance while the Outlook client is offline or inactive. When a user logs into their Outlook client, the mail data is already prepopulated on the client-side Steelhead appliance. This accelerates the first access of the client&#8217;s e-mail, which is retrieved with LAN-like performance.</div>
            <div class="CellBody"><a name="505658">Transparent prepopulation creates virtual MAPI connections to the Exchange server for </a>Outlook clients that are offline. When the remote Steelhead appliance detects that an Outlook client has shut down, the virtual MAPI connections are triggered. The remote Steelhead appliance uses these virtual connections to pull mail data from the Exchange server over the WAN link.</div>
            <div class="CellBody"><a name="505665">You must enable this feature on the server-side and client-side Steelhead appliance. By </a>default, MAPI transparent prepopulation is enabled. </div>
            <div class="CellBody"><a name="505666">MAPI prepopulation does not use any additional Client Access Licenses (CALs). The </a>Steelhead appliance holds open a existing authenticated MAPI connection after Outlook is shut down. No user credentials are used or saved by the Steelhead appliance when performing prepopulation.</div>
            <div class="CellBody"><a name="505679">In RiOS v6.5 or later, the client-side Steelhead appliance controls MAPI prepopulation v2. </a>This allows for a higher rate of prepopulated session, and enables the MAPI prepopulation to take advantage of the read-ahead feature in the MAPI optimization blade.</div>
            <div class="CellBody"><a name="505683">MAPI prepopulation v2 is supported in RiOS v6.0.4 or later, v6.1.2 or later, and v6.5 or </a>later. The client-side and server-side Steelhead appliance can be running any of these code train levels and provide prepopulation v2 capabilities: for example, a client-side Steelhead appliance running RiOS v6.0.4 connecting to a server-side Steelhead appliance running RiOS v6.5 provides prepopulation v2 capabilities. In contrast, a 6.0.1a client-side Steelhead appliance connecting to a RiOS v6.5 server-side Steelhead appliance supports prepopulation v1, but does not provide prepopulation v2.</div>
            <div class="CellBody"><a name="505708">If a user starts a new Outlook session, the MAPI prepopulation session terminates. If for </a>some reason the MAPI prepopulation session does not terminate (for example, the user starts a new session in a location that is different than the Steelhead appliance that has the MAPI prepopulation session active), the MAPI prepopulation session eventually times-out per the configuration setting.</div>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="505712">MAPI transparent prepopulation is not started with Outlook Anywhere connections. </a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505714">Max Connections</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505716">Specify the maximum number of virtual MAPI connections to the Exchange server for </a>Outlook clients that have shut down. Setting the maximum connections limits the aggregate load on all Exchange servers through the configured Steelhead appliance. The default value varies by model; for example, on a 5520 the default is 3750.</div>
            <div class="CellBody"><a name="505720">You must configure the maximum connections on both the client and server-side of the </a>network. In RiOS 7.0, the maximum connections setting is only used by the client-side Steelhead appliance.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505728">Poll Interval (minutes)</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505730">Sets the number of minutes you want the appliance to check the Exchange server for </a>newly-arrived email for each of its virtual connections. The default value is 20.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505732">Time Out (hours)</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="505734">Specify the number of hours after which to time-out virtual MAPI connections. When this </a>threshold is reached, the virtual MAPI connection is terminated. The time-out is enforced on a per-connection basis. Time-out prevents a buildup of stale or unused virtual connections over time. The default value is <span class="Bold" style="font-weight: normal">96</span>.</div>
          </td>
        </tr>
      </table>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="252971">Click </a><span class="Bold">Apply</span> to apply your settings to the running configuration.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="252972">Click </a><span class="Bold">Save </span>to save your settings permanently.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Tip">
        <span class="Bold">Tip: </span><a name="252973">When you have verified appropriate changes, you can write the active configuration that is stored in memory to </a>the active configuration file (or you can save it as any filename you choose). For details on saving configurations, see <span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupConfig.html#281818', '');" title="Managing Configuration Files">Managing Configuration Files</a></span>.</div>
      <div class="Heading2"><a name="252978">Optimizing MAPI Exchange in Out-of-Path Deployments</a></div>
      <div class="Body"><a name="252979">In out-of-path deployments, if you want to optimize MAPI Exchange by destination port, you must define </a>a fixed-target, in-path rule that specifies the following ports on the client-side appliance:</div>
      <li class="Bullet"><span class="Bold"><a name="252981">Port 135</a></span> - The Microsoft end-point mapper port.</li>
      <li class="Bullet"><span class="Bold"><a name="252986">Port 7830</a></span> - The Steelhead appliance port used for Exchange traffic.</li>
      <li class="Bullet"><span class="Bold"><a name="252991">Port 7840</a></span> - The Steelhead appliance port used for Exchange Directory NSPI traffic.</li>
      <div class="Body"><a name="252995">For details on defining in-path rules, see </a><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'in-path-rules.04.1.html#322397', '');" title="Configuring In-Path Rules">Configuring In-Path Rules</a></span>.</div>
      <div class="Heading2"><a name="490735">Deploying Steelhead Appliances with Exchange Servers Behind Load </a>Balancers</div>
      <div class="Body"><a name="490807">Beginning with RiOS v6.1.4, 6.5.1, and later, you can configure Steelhead appliances to operate with </a>Exchange server clusters that use load balancers (such as CAS) to provide dynamic MAPI port mappings for clients. </div>
      <div class="Body"><a name="491020">In these environments, you must configure one of the following on the client-side Steelhead appliance:</a></div>
      <li class="Bullet"><a name="491112">Enable port transparency for MAPI traffic. For details, see </a><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceInpathRules.html#322503', '');" title="Configuring In-Path Rules">Configuring In-Path Rules</a></span> and the <span class="book_title">Riverbed </span><span class="book_title">Deployment Guide</span>.</li>
      <li class="Bullet"><a name="491410">Enable full transparency for MAPI traffic. For details, see </a><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceInpathRules.html#322503', '');" title="Configuring In-Path Rules">Configuring In-Path Rules</a></span> and the <span class="book_title">Riverbed </span><span class="book_title">Deployment Guide</span>.</li>
      <li class="Bullet"><a name="491205">Disable MAPI port remapping using the CLI command </a><span style="font-weight: bold">no protocol mapi port-remap enable</span>. After entering this command, restart the optimization service. For details, see the <span class="book_title">Riverbed Command-Line </span><span class="book_title">Interface Reference Manual</span>.</li>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <hr align="left" />
    <table align="right">
      <tr>
        <td class="WebWorks_Company_Logo_Bottom">
          <a href="http://riverbed.com" target="external_window"><img src="riverbed_logo_without_tagline.jpg" border="0" /></a>
        </td>
      </tr>
    </table>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>