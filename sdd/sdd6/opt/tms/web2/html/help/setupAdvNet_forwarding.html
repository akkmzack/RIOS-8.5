<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Configuring Connection Forwarding Features</title>
    <link rel="StyleSheet" href="css/advanced-networking.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
  </head>
  <body onload="WWHUpdate();" onunload="WWHUnload();" onkeydown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onkeypress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onkeyup="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <a class="WebWorks_Breadcrumb_Link" href="advanced-networking.08.01.html#279521">Chapter 6	Configuring Network Integration Features</a> : Configuring Connection Forwarding Features</div>
    <hr align="left" />
    <blockquote>
      <div class="Heading1Topic"><a name="279521">Configuring Connection Forwarding Features</a></div>
      <div class="Body"><a name="279523">You configure connection forwarding for a network with multiple paths from the server in the Configure &gt; </a>Networking &gt; Connection Forwarding page. </div>
      <div class="Body"><span style="font-size: 9.0pt"><a name="279527"><img class="Default" src="images/icon_CSH.png" width="15" height="15" style="display: inline; float: none; left: 0.0; top: 0.0" alt="" /> </a></span>The AWS Cloud Steelhead does not support connection forwarding; however, the ESX Cloud Steelhead supports it.</div>
      <div class="Body"><a name="279528">You enable connection forwarding only in asymmetric networks; that is, networks in which a client request </a>traverses a different network path than the server response. The default port for connection forwarding is <span class="Bold" style="font-weight: normal">7850</span>. </div>
      <div class="Body"><a name="279532">For virtual in-path deployments with multiple Steelhead appliances, including WCCP clusters and </a>connection forwarding, you must always allow<span style="font-weight: bold"> </span>in-path neighbor failure. This is because certain events, such as network failures, and router or Steelhead appliance cluster changes, can cause routers to change the destination Steelhead appliance for TCP connection packets. When this happens, Steelhead appliances must be able to redirect traffic to each other to ensure that optimization continues.</div>
      <div class="Body"><a name="279542">To optimize connections in asymmetric networks, packets traveling in both directions must pass through </a>the same client-side and server-side Steelhead appliance. If you have one path from the client to the server and a different path from the server to the client, you must enable in-path connection forwarding and configure the Steelhead appliances to communicate with each other. These Steelhead appliances are called neighbors and exchange connection information to redirect packets to each other. </div>
      <div class="Body"><a name="336112">In RiOS v6.5 and later, you must enable connection forwarding in a WCCP cluster. With connection </a>forwarding enabled, the WCCP load balancing algorithm considers the total number of in-path interfaces of all neighbors in the service group when balancing the load across the interfaces. If you do not enable connection forwarding, the Steelhead with the lowest IP address assigns all traffic flows to itself. For details, see the <span class="book_title">Riverbed Deployment Guide</span>.</div>
      <div class="Body"><a name="279556">Neighbors can be placed in the same physical site or in different sites, but the latency between them should </a>be small because the packets travelling between them are not optimized.</div>
      <div class="Important">
        <span class="Bold">Important: </span><a name="279560">When you define a neighbor, you specify the Steelhead appliance in-path IP address, not the primary IP </a>address.</div>
      <div class="Body"><a name="279564">If there are more than two possible paths, additional Steelhead appliances must be installed on each path </a>and configured as neighbors. Neighbors are notified in parallel so that the delay introduced at the connection setup is equal to the time it takes to get an acknowledgement from the furthest neighbor. </div>
      <div class="Important">
        <span class="Bold">Important: </span><a name="279567">Connection forwarding neighbors must use the same WAN visibility mode. For details, see </a><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceInpathRules.html#322503', '');" title="Configuring In-Path Rules">Configuring In-Path Rules</a></span>.</div>
      <div class="Body"><a name="279572">For details on connection forwarding, see the </a><span class="book_title">Riverbed Deployment Guide</span>.</div>
      <div class="HeadingProcedure"><a name="279573">To enable connection forwarding</a></div>
      <div class="Step1_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step1_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step1_inner"><a name="279574">Choose Configure &gt; Networking &gt; Connection Forwarding to display the Connection Forwarding page.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="279579">Under Connection Forwarding Settings, complete the configuration as described in the following table.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <table class="RegularTable" style="text-align: left; width: 468.49608pt" cellspacing="0" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 142.02216pt">
            <div class="CellHeading"><a name="279582">Control</a></div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 326.47392pt">
            <div class="CellHeading"><a name="279584">Description</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279586">Enable Connection Forwarding</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279588">Enables connection forwarding by default on all neighbors added to the peer </a>list. The default value is <span class="Bold" style="font-weight: normal">7850</span>.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279590">Port</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279594">Specify the port number to use as the default for the neighbor Steelhead </a>appliance in-path port. The default value is 7850.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279597">Keep-Alive Interval</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279599">Specify the number of seconds to use as the default interval for </a><span class="Bold" style="font-weight: normal">ping</span> commands between neighbor Steelhead appliances. </div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279604">Keep-Alive Count</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279606">Specify the number of tries to use as the default number of failed </a><span class="Bold" style="font-weight: normal">ping</span> attempts before an appliance terminates a connection with a neighbor. The default value is 3.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279608">In-Path Neighbor Failure</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279610">Uses the neighbor appliance to optimize new connections if the appliance fails.</a></div>
            <div class="CellBody"><a name="279611">For in-path deployments that use connection forwarding with WCCP, enabling </a>this option ensures that if one appliance fails, the neighbor appliance continues to optimize new connections. </div>
            <div class="CellBody"><a name="279612">For in-path deployments that use connection forwarding without WCCP, </a>enabling this option ensures that a Steelhead appliance attempts to optimize new connections that are symmetrically routed, even after all of the neighbor Steelhead appliances on another network path failed. New asymmetrically routed connections are not optimized but passed through.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279620">Multiple Interface Support</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279625">Enables high availability on Steelhead appliances configured with multiple in-</a>path interfaces and using connection forwarding with another multiport Steelhead appliance. This option makes all neighbor in-path interface IP addresses visible to each peer to ensure proper neighbor communication if the in-path0_0 interface fails.</div>
            <div class="CellBody"><a name="336154">RiOS v6.5 and later requires connection forwarding in a WCCP cluster.</a></div>
          </td>
        </tr>
      </table>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="279630">Click </a><span class="Bold">Apply</span> to apply your settings.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="279631">Click </a><span class="Bold">Save </span>to save your settings permanently.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="HeadingProcedure"><a name="279632">To add a new neighbor</a></div>
      <div class="Step1_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step1_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step1_inner"><a name="279633">Under Neighbor Table, complete the configuration as described in the following table.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <table class="RegularTable" style="text-align: left; width: 468.49608pt" cellspacing="0" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 142.02216pt">
            <div class="CellHeading"><a name="279636">Control</a></div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 326.47392pt">
            <div class="CellHeading"><a name="279638">Description</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279640">Add a New Neighbor</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279642">Displays the controls to add a new neighbor.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279644">Hostname </a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279646">Specify a hostname.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279648">In-Path IP Address</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279653">Specify the in-path IP address for the neighbor Steelhead appliance. When you </a>define a neighbor, you must specify the appliance in-path IP address, not the primary IP address.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279655">Port</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279660">Specify the in-path port for the neighbor Steelhead appliance. The default port </a>is <span class="Bold" style="font-weight: normal">7850</span>.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279662">Additional IP Addresses</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279667">Adds a neighbor Steelhead appliance to the neighbor list.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279669">Add </a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279671">Adds a new neighbor.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279673">Remove Selected</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="279675">Select the check box next to the name and click </a><span style="font-weight: bold">Remove Selected</span>. </div>
          </td>
        </tr>
      </table>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="279677">Click </a><span class="Bold">Apply</span> to apply your settings.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="279678">Click </a><span class="Bold">Save </span>to save your settings permanently.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Tip">
        <span class="Bold">Tip: </span><a name="279679"> To modify the neighbor properties, select the IP address of the neighbor and complete the configuration.</a></div>
      <div class="Heading4"><a name="279680">Related Topics</a></div>
      <li class="Bullet"><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceGeneral.html#249507', '');" title="Configuring General Service Settings" name="279684">Configuring General Service Settings</a></span></li>
      <li class="Bullet"><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupAdvNet_asymmetric.html#279300', '');" title="Configuring Asymmetric Routing Features" name="279688">Configuring Asymmetric Routing Features</a></span></li>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <hr align="left" />
    <table align="right">
      <tr>
        <td class="WebWorks_Company_Logo_Bottom">
          <a href="http://riverbed.com" target="external_window"><img src="riverbed_logo_without_tagline.jpg" border="0" /></a>
        </td>
      </tr>
    </table>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>