<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>About Regular and Enhanced Automatic Discovery</title>
    <link rel="StyleSheet" href="css/optimization.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
  </head>
  <body onload="WWHUpdate();" onunload="WWHUnload();" onkeydown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onkeypress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onkeyup="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <a class="WebWorks_Breadcrumb_Link" href="optimization.05.01.html#249905">Chapter 3	Configuring Optimization Features</a> : <a class="WebWorks_Breadcrumb_Link" href="setupAdvNet_peering.html#249905">Enabling Peering and Configuring Peering Rules</a> : About Regular and Enhanced Automatic Discovery</div>
    <hr align="left" />
    <blockquote>
      <div class="Heading2Topic"><a name="249905">About Regular and Enhanced Automatic Discovery</a></div>
      <div class="Body"><a name="249912">With enhanced automatic discovery, the Steelhead appliance automatically finds the furthest Steelhead </a>appliance peer in a network and optimization occurs there. By default, enhanced auto-discovery is enabled. When enhanced auto-discovery is disabled, the Steelhead appliance uses regular auto-discovery. With regular auto-discovery, the Steelhead appliance finds the next appliance in the group and optimization occurs there. </div>
      <div class="Body"><a name="249919">In some deployments, enhanced auto-discovery can simplify configuration and make your deployments </a>more scalable. When enhanced auto-discovery is enabled, the Steelhead appliance automatically finds the furthest Steelhead appliance in a network and optimization occurs there: for example, if you had a deployment with four Steelhead appliance (A, B, C, D), where D represents the appliance that is furthest from A, the Steelhead appliance automatically finds D. This simplifies configuration and makes your deployment more scalable.</div>
      <div class="Body"><span style="font-size: 9.0pt"><a name="336172"><img class="Default" src="images/icon_CSH.png" width="15" height="15" style="display: inline; float: none; left: 0.0; top: 0.0" alt="" /></a></span> The Cloud Steelhead does not use automatic peering. When you run a server in the cloud, you deploy the Cloud Steelhead to be the furthest Steelhead in the network because the Discovery Client on the server is configured to use the Cloud Steelhead automatically. When you run a client in the cloud, and there are multiple Steelheads in the path to the server, the Cloud Steelhead is selected for optimization first. You can enable automatic peering on the remote Steelheads to make the Cloud Steelhead peer with the furthest Steelhead in the network.</div>
      <div class="Body"><a name="270054">Enhanced auto-discovery is recommended for the deployments described in the following table.</a></div>
      <table class="RegularTable" style="text-align: left; width: 469.50120000000004pt" cellspacing="0" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 145.06272pt">
            <div class="CellHeading"><a name="249935">Deployment Type</a></div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 324.43848pt">
            <div class="CellHeading"><a name="249937">Description</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="249939">Serial Cascade Deployments</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="249942">Cascade configurations enable optimal multisite deployments where </a>connections between the client and the server might pass through intermediate Steelhead appliances to reach their final destination. </div>
            <div class="CellBody"><a name="249949">Enhanced auto-discovery for cascading Steelhead appliances detects when </a>more than two Steelhead appliances are present between the client and the server and automatically chooses the two outside Steelhead appliances, optimizing all traffic in between.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="249957">Serial Cluster Deployments</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="249961">You can provide increased optimization by deploying two or more Steelhead </a>appliances back-to-back in an in-path configuration to create a serial cluster. </div>
            <div class="CellBody"><a name="249964">Appliances in a serial cluster process the peering rules you specify in a spill-</a>over fashion. When the maximum number of TCP connections for a Steelhead appliance is reached, that appliance stops intercepting new connections. This allows the next Steelhead appliance in the cluster the opportunity to intercept the new connection, if it has not reached its maximum number of connections. The in-path peering rules and in-path rules tell the Steelhead appliance in a cluster not to intercept connections between themselves.</div>
            <div class="CellBody"><a name="249977">You configure peering rules that define what to do when a Steelhead appliance </a>receives an auto-discovery probe from another Steelhead appliance. </div>
            <div class="CellBody"><a name="249981">You can deploy serial clusters on the client or server-side of the network. </a></div>
            <div class="CellHeading"><a name="503518">Supported models</a></div>
            <div class="CellHeading"><a name="503519">&nbsp;</a></div>
            <div class="CellBody"><a name="503523">Two-appliance serial clusters are supported for all Steelhead appliance </a><span style="font-style: italic">xx</span>20 and <span style="font-style: italic">xx</span>50 models, except the 250 model. The Steelhead appliances must be the same model running RiOS v5.5.3 or later or RiOS v5.0.8. </div>
            <div class="CellBody"><a name="503536">The following Steelhead appliance models support serial clusters: </a></div>
            <div class="CellIndent1"><a name="503537">550 series, 1050 series, 2050, 5050, 6050, 7050, 1020, 2020, 3020, 3520, 5000, </a>5010, 5520, and 6020 </div>
            <div class="CellBody"><a name="503538">These models can reach their specifications even while potentially passing </a>through the LAN-side traffic for optimized connections for the other Steelhead appliance in the cluster.</div>
            <div class="CellBody"><a name="503548">Steelhead appliance xx20 models do not support RiOS v7.0 and later releases.</a></div>
            <div class="CellBody"><a name="503552">When running a RiOS software version earlier than v5.5.3, models 5520, 6020, </a>and 6120 are qualified by Riverbed for serial clusters.</div>
            <div class="CellImportant">
              <span class="Bold">Important: </span><a name="250006">For environments that want to optimize MAPI or FTP traffic which </a>require all connections from a client to be optimized by one Steelhead appliance, Riverbed strongly recommends using the master and backup redundancy configuration instead of a serial cluster. For larger environments that require multiappliance scalability and high availability, Riverbed recommends using the Interceptor to build multiappliance clusters. For details, see the <span class="book_title">Riverbed </span><span class="book_title">Deployment Guide</span> and the <span class="book_title">Interceptor Appliance User&#8217;s Guide</span>.</div>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="250028">A serial cluster has the same bandwidth specification as the Steelhead </a>appliance model deployed in the cluster. The bandwidth capability does not increase because the cluster contains more than one Steelhead appliance: for example, a serial cluster comprised of two Steelhead appliance 2050M models with a bandwidth specification of 20-Mbps has a bandwidth specification of 20 Mbps.</div>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="250039">If the active Steelhead appliance in the cluster enters a degraded state </a>because the CPU load is too high, it continues to accept new connections.</div>
          </td>
        </tr>
      </table>
      <div class="Body"><a name="250044">For details on these deployment types, see the </a><span class="book_title">Riverbed Deployment Guide</span>.</div>
      <div class="Heading3"><a name="250045">Extending the Number of Peers</a></div>
      <div class="Body"><a name="250053">RiOS supports a large number of peers (up to 20,000) per Steelhead appliance. </a>This feature is available only on Steelhead appliance models 5050, 5520, 6020, 6050, 6120, and 7050. Riverbed recommends enabling the extended peer table if you have more than 4,000 peers. After enabling extended peer table support, you must clear the RiOS data store and stop and restart the service. See <span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'optimization.05.04.html#250061', '');" title="About Regular and Enhanced Automatic Discovery">Configuring Peering</a></span>.</div>
      <div class="Heading2"><a name="250061">Configuring Peering </a></div>
      <div class="Body"><a name="250062">You can display, add, and modify auto-discovery peering settings in the Configure &gt; Optimization &gt; </a>Peering Rules page. You can also enable extended peer table support.</div>
      <div class="HeadingProcedure"><a name="250063">To enable enhanced auto-discovery</a></div>
      <div class="Step1_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step1_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step1_inner"><a name="250064">Choose Configure &gt; Optimization &gt; Peering Rules to display the Peering Rules page.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="250069">Under Settings, complete the configuration as described in the following table.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <table class="RegularTable" style="text-align: left; width: 468.87624000000005pt" cellspacing="0" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #ADBDF2; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 144.43776pt">
            <div class="CellHeading"><a name="503952">Control</a></div>
          </td>
          <td style="background-color: #ADBDF2; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 324.43848pt">
            <div class="CellHeading"><a name="503954">Description</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="503957">Enable Enhanced Auto-Discovery</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="503962">Enables enhanced auto-discovery. With enhanced auto-discovery, the Steelhead </a>appliance automatically finds the furthest Steelhead appliance along the connection path of the TCP connection, and optimization occurs there: for example, in a deployment with four Steelhead appliances (A, B, C, D), where D represents the appliance that is furthest from A, the Steelhead appliance automatically finds D. This simplifies configuration and makes your deployment more scalable.</div>
            <div class="CellBody"><a name="503975">By default, enhanced auto-discovery peering is enabled. Without enhanced </a>auto-discovery, the Steelhead appliance uses regular auto-discovery. With regular auto-discovery, the Steelhead appliance finds the first remote Steelhead appliance along the connection path of the TCP connection, and optimization occurs there: for example, if you had a deployment with four Steelhead appliances (A, B, C, D), where D represents the appliance that is furthest from A, the Steelhead appliance automatically finds B, then C, and finally D, and optimization takes place in each.</div>
            <div class="CellBody"><a name="503991">For detailed information about deployments that require enhanced auto-</a>discovery peering, see the <span class="book_title">Riverbed Deployment Guide</span>.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="503996">Enable Extended Peer Table</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504002">Enables support for up to 20,000 peers on high-end server-side Steelhead </a>appliances (models 5050, 5520, 6020, 6050, 6120, and 7050) to accommodate large Steelhead client deployments. The RiOS data store maintains the peers in groups of 1,024 in the global peer table. </div>
            <div class="CellBody"><a name="504014">Riverbed recommends enabling the extended peer table if you have more than </a>4,000 peers.</div>
            <div class="CellBody"><a name="504018">By default, this option is disabled and it is unavailable on Steelhead appliance </a>models that do not support it.</div>
            <div class="CellImportant">
              <span class="Bold">Important: </span><a name="504019">Before enabling this feature you must have a thorough </a>understanding of performance and scaling issues. When deciding whether to use extended peer table support, you should compare it with a serial cluster deployment. For details on serial clusters, see the <span class="book_title">Riverbed Deployment Guide</span>.</div>
            <div class="CellBody"><a name="504026">After enabling this option, you must clear the RiOS data store and stop and </a>restart the service. </div>
          </td>
        </tr>
      </table>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="250141">Click </a><span class="Bold">Apply</span> to apply your settings. If you have enabled Extended Peer Table Support, a message tells you to clear the RiOS data store and restart the service. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="250142">Click </a><span class="Bold">Save</span> to save your settings permanently.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Heading3"><a name="250146">Peering Rules</a></div>
      <div class="Body"><a name="250150">Peering rules control Steelhead appliance behavior when it sees probe queries. </a></div>
      <div class="Body"><a name="250154">Peering rules are an ordered list of fields a Steelhead appliance uses to match with incoming SYN packet </a>fields (for example, source or destination subnet, IP address, VLAN, or TCP port) as well as the IP address of the probing Steelhead appliance. This is especially useful in complex networks.</div>
      <div class="Heading4"><a name="250158">The Peering Rules List</a></div>
      <div class="Body"><a name="250159">The Peering Rules page displays a list of peering rules. The list contains the default peering rules and any </a>peering rules you add. </div>
      <div class="Body"><a name="250160">The system evaluates the rules in numerical order starting with rule </a><span class="Bold" style="font-weight: normal">1</span>. If the conditions set in the rule match, then the rule is applied. If the conditions set in the rule do not match, then the rule is not applied and the system moves on to the next rule: for example, if the conditions of rule 1 do not match, rule <span class="Bold" style="font-weight: normal">2</span> is consulted. If rule <span class="Bold" style="font-weight: normal">2</span> matches the conditions, it is applied, and no further rules are consulted. </div>
      <div class="Body"><a name="250164">The </a><span class="Bold" style="font-weight: normal">Rule Type </span>of a matching rule determines which action the Steelhead appliance takes on the connection.</div>
      <div class="Heading4"><a name="272189">About the Default Peering Rules</a></div>
      <div class="Body"><a name="272190">The default peering rules are adequate for typical network configurations, such as in-path configurations. </a>However, you might need to add peering rules for complex network configurations. For details on deployment cases requiring peering rules, see the <span class="book_title">Riverbed Deployment Guide</span>.</div>
      <div class="Note">
        <span class="Bold">Note: </span><a name="272197">Riverbed recommends using in-path rules to optimize SSL connections on destination ports other than the default </a>port 443. For details, see <span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceInpathRules.html#322503', '');" title="Configuring In-Path Rules">Configuring In-Path Rules</a></span>.</div>
      <li class="Bullet"><a name="272201">The default peering rule number 1 with the</a><span class="Bold"> </span>SSL<span class="Bold"> </span>incapable flag matches any SSL connection whose IP address and destination port appear in the list of bypassed clients and servers in the Configure &gt; Optimization &gt; SSL Main Settings page. The bypassed list includes the IP addresses and port numbers of SSL servers that the Steelhead appliance is bypassing because it could not match the common name of the server&#8217;s certificate with one in its certificate pool. The list also includes servers and clients whose IP address and port combination have experienced an SSL handshake failure: for example, a handshake failure occurs when the Steelhead appliance cannot find the issuer of a server certificate on its list of trusted certificate authorities. </li>
      <div class="Indent1"><span style="font-weight: bold"><a name="272208">Note</a></span>: After a server or client appears in the bypassed servers list, follow-on connections to the same destination IP and port number always match rule number 1. </div>
      <li class="Bullet"><a name="272209">The default peering rule number 2 with the SSL</a> capable flag matches connections on port 443 that did not match default peering rule number 1. RiOS versions prior to v6.0 required a valid SSL server certificate to have been installed and the specific IP address and port associated with them to be configured. In RiOS v6.0 or later, the Steelhead appliance attempts to automatically discover certificate matches for servers answering on port 443. For all connections that match, the Steelhead appliance performs both enhanced auto-discovery (finding the nearest and farthest Steelhead appliance pair) and SSL optimization. </li>
      <div class="HeadingProcedure"><a name="250185">To configure a peering rule</a></div>
      <div class="Step1_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step1_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step1_inner"><a name="250186">To add, move, or remove a peering rule, complete the configuration as described in the following table. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <table class="RegularTable" style="text-align: left; width: 468.87624000000005pt" cellspacing="0" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #ADBDF2; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 144.43776pt">
            <div class="CellHeading"><a name="504033">Control</a></div>
          </td>
          <td style="background-color: #ADBDF2; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 324.43848pt">
            <div class="CellHeading"><a name="504035">Description</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504037">Add a New Peering Rule</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504039">Displays the controls for adding a new peering rule.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504041">Rule Type</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504046">Determines which action the Steelhead appliance takes on the connection. </a>Select one of the following rule types from the drop-down list:</div>
            <li class="CellBullet"><span class="Bold"><a name="504047">Auto</a></span><span class="Bold" style="font-weight: normal"> - </span>Allows built-in functionality to determine the response for peering requests (performs the best peering possible). If the receiving Steelhead appliance is not using automatic auto-discovery, this has the same effect as the <span class="Bold">Accept </span>peering rule action. If automatic auto-discovery is enabled, the Steelhead appliance only becomes the optimization peer if it is the last Steelhead appliance in the path to the server. </li>
            <li class="CellBullet"><span class="Bold"><a name="504057">Accept</a></span><span class="Bold" style="font-weight: normal"> - </span>Accepts peering requests that match the source-destination-port pattern. The receiving Steelhead appliance responds to the probing Steelhead appliance and becomes the remote-side Steelhead appliance (that is, the peer Steelhead appliance) for the optimized connection.</li>
            <li class="CellBullet"><span class="Bold"><a name="504070">Passthrough</a></span><span class="Bold" style="font-weight: normal"> - </span>Allows pass-through peering requests that match the source and destination port pattern. The receiving Steelhead appliance does not respond to the probing Steelhead appliance, and allows the SYN+probe packet to continue through the network.</li>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504078">Insert Rule At</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504080">Determines the order in which the system evaluates the rule. Select Start, End, </a>or a rule number from the drop-down list.</div>
            <div class="CellBody"><a name="504081">The system evaluates rules in numerical order starting with rule </a><span class="Bold" style="font-weight: normal">1</span>. If the conditions set in the rule match, then the rule is applied and the system moves on to the next rule: for example, if the conditions of rule 1 do not match, rule <span class="Bold" style="font-weight: normal">2</span> is consulted. If rule <span class="Bold" style="font-weight: normal">2</span> matches the conditions, it is applied, and no further rules are consulted. </div>
            <div class="CellBody"><a name="504084">The </a><span class="Bold" style="font-weight: normal">Rule Type </span>of a matching rule determines which action the Steelhead appliance takes on the connection.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504087">Source Subnet</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504089">Specify an IP address and mask for the traffic source, or you can specify </a><span class="Bold" style="font-weight: normal">all</span> or <span class="Bold" style="font-weight: normal">0.0.0.0/0 </span>as the wildcard for all traffic.</div>
            <div class="CellBody"><a name="504090">Use the following format: </a><span class="Bold" style="font-weight: normal">XXX.XXX.XXX.XXX/XX.</span></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top" rowspan="2">
            <div class="CellBody"><a name="504092">Destination Subnet</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504094">Specify an IP address and mask pattern for the traffic destination, or you can </a>specify <span class="Bold" style="font-weight: normal">all</span> or <span class="Bold" style="font-weight: normal">0.0.0.0/0 </span>as the wildcard for all traffic.</div>
            <div class="CellBody"><a name="504095">Use the following format: </a><span class="Bold" style="font-weight: normal">XXX.XXX.XXX.XXX/XX.</span></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><span class="Bold"><a name="504099">Port</a></span><span class="Bold" style="font-weight: normal"> - </span>Specify the destination port number, port label, or all. </div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504101">Peer IP Address</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504106">Specify the in-path IP address of the probing Steelhead appliance. If more than </a>one in-path interface is present on the probing Steelhead appliance, apply multiple peering rules, one for each in-path interface.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504112">SSL Capability</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504114">Enables an SSL capability flag, which specifies a criteria for matching an </a>incoming connection with one of the rules in the peering rules table. This flag is typically set on a server-side Steelhead appliance.</div>
            <div class="CellBody"><a name="504118">Select one of the following options from the drop-down list to determine how </a>to process attempts to create secure SSL connections:</div>
            <li class="CellBullet"><span class="Bold"><a name="504119">No Check</a></span><span class="Bold" style="font-weight: normal"> - </span>The peering rule does not determine whether the server Steelhead appliance is present for the particular destination IP address and port combination.</li>
            <li class="CellBullet"><span class="Bold"><a name="504123">Capable</a></span><span class="Bold" style="font-weight: normal"> - </span>The peering rule determines that the connection is SSL-capable if the destination port is 443 (irrespective of the destination port value on the rule), and the destination IP and port do not appear on the bypassed servers list. The Steelhead appliance accepts the condition and, assuming all other proper configurations and that the peering rule is the best match for the incoming connection, optimizes SSL.</li>
            <li class="CellBullet"><span class="Bold"><a name="504127">Incapable</a></span><span class="Bold" style="font-weight: normal"> - </span>The peering rule determines that the connection is SSL-incapable if the destination IP and port appear in the bypassed servers list. The service adds a server to the bypassed servers list when there is no SSL certificate for the server or for any other SSL handshake failure. The Steelhead appliance passes the connection through unoptimized without affecting connection counts.</li>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="504134">Riverbed recommends that you use in-path rules to optimize SSL </a>connections on non-443 destination port configurations.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504136">Description</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504138">Specify a description to help you identify the peering relationship.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504140">Add</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504142">Adds a peering rule to the list.</a></div>
            <div class="CellBody"><a name="504146">The Management Console redisplays the Peering Rules table and applies your </a>modifications to the running configuration, which is stored in memory.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504148">Remove Selected Rules</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504150">Select the check box next to the name and click </a><span style="font-weight: bold">Remove Selected Rules</span>.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-right-color: none; border-right-style: none; border-right-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504152">Move Selected Rules </a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-left-color: none; border-left-style: none; border-left-width: 0.0pt; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="504154">Select the check box next to the rule and click </a><span style="font-weight: bold">Move Selected Rules</span>. Click the arrow next to the desired rule position; the rule moves to the new position.</div>
          </td>
        </tr>
      </table>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="250321">Click </a><span class="Bold">Save</span> to save your settings permanently.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Heading4"><a name="260687">Preventing an Unknown (or Unwanted) Steelhead Appliance from Peering</a></div>
      <div class="Body"><a name="504162">Enhanced auto-discovery greatly reduces the complexities and time it takes to deploy Steelhead appliances. </a>It works so seamlessly that occasionally it has the undesirable effect of peering with Steelheads on the Internet that are not in your organization's management domain or your corporate business unit. When an unknown (or unwanted) Steelhead appears connected to your network, you can create a peering rule to prevent it from peering and remove it from your list of connected appliances. The peering rule defines what to do when a Steelhead appliance receives an auto-discovery probe from the unknown Steelhead appliance. </div>
      <div class="HeadingProcedure"><a name="504172">To prevent an unknown Steelhead from peering</a></div>
      <div class="Step1_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step1_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step1_inner"><a name="504173">Choose Configure &gt; Optimization &gt; Peering Rules.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="504174">Click </a><span style="font-weight: bold">Add a New Peering Rule</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="504175">Select Passthrough as the rule type.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="504176">Specify the source and destination subnets. The source subnet is the remote location network subnet (in </a>the format XXX.XXX.XXX.XXX/XX). The destination subnet is your local network subnet (in the format XXX.XXX.XXX.XXX/XX).</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="504177">Click </a><span style="font-weight: bold">Add</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Indent1"><a name="504181">In this example, the peering rule passes through traffic from the unknown Steelhead in the remote </a>location.</div>
      <div class="Note">
        <span class="Bold">Note: </span><a name="504182">When you use this method and add a new remote location in the future, you must create a new peering rule that </a>accepts traffic from the remote location. Place this new Accept rule before the Pass-through rule.</div>
      <div class="Indent1"><a name="504183">If you do not know the network subnet for the remote location, there is another option: you can create </a>a peering rule that allows peering from your corporate network subnet and denies it otherwise: for example, create a peering rule that accepts peering from your corporate network subnet and place it as the first rule in the list. Next, create a second peering rule to pass-through all other traffic. In this example, when the local Steelhead receives an auto-discovery probe, it checks the peering rules first (from top to bottom). If it matches the first Accept rule, the local Steelhead peers with the other Steelhead. If it does not match the first Accept rule, the local Steelhead checks the next peering rule, which is the pass-through rule for all other traffic. In this case, the local Steelhead appliance just passes through the traffic, and does not peer with the other Steelhead appliance.</div>
      <div class="Body"><a name="504199">After you add the peering rule, the unknown Steelhead appliance appears in the Current Connections </a>report as a Connected Appliance until the connection times out. After the connection becomes inactive, it appears dimmed. To remove the unknown appliance completely, restart the optimization service.</div>
      <div class="Heading4"><a name="260799">Related Topics</a></div>
      <li class="Bullet"><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceInpathRules.html#322503', '');" title="Configuring In-Path Rules" name="250326">Configuring In-Path Rules</a></span></li>
      <li class="Bullet"><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceGeneral.html#249507', '');" title="Configuring General Service Settings" name="250334">Configuring General Service Settings</a></span></li>
      <li class="Bullet"><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupPortLabels.html#251342', '');" title="Configuring Port Labels" name="250338">Configuring Port Labels</a></span></li>
      <li class="Bullet"><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'setupServiceProtocolsSSLPeering.html#222181', '');" title="Configuring Secure Peers" name="260823">Secure Inner Channel Overview</a></span></li>
      <li class="Bullet"><span class="xref"><a href="javascript:WWHClickedPopup('cx_test', 'reportConnections.html#296976', '');" title="Viewing Current Connections" name="260812">Viewing Current Connections</a></span></li>
      <div class="Pbreak_H1"><a name="431485">&nbsp;</a></div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <hr align="left" />
    <table align="right">
      <tr>
        <td class="WebWorks_Company_Logo_Bottom">
          <a href="http://riverbed.com" target="external_window"><img src="riverbed_logo_without_tagline.jpg" border="0" /></a>
        </td>
      </tr>
    </table>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>