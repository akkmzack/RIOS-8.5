#!/usr/bin/env python
#  Filename:  $Source$
#  Revision:  $Revision: 51619 $
#  Date:      $Date: 2009-05-14 00:51:19 -0700 (Thu, 14 May 2009) $
#  Author:    $Author: jshilkaitis $
# 
#  (C) Copyright 2003-2008 Riverbed Technology, Inc.  
#  All rights reserved.

###############################################################################
# Definitions for disk firmware updates
# 
###############################################################################

###############################################################################
# Seagate ST320310NS 250GB and 500 Gb
#
# Firmwares are of the form SN* 
#
###############################################################################
def seag_es2_cmp(fw_cfg_info, fw_str):
    # check if the drive fw string is one we understand
    if fw_str[0:2] != "SN":
        return 'unknown'

    try:
        image_fw_ver = int(fw_cfg_info.get_firmware()[2:4])
    except ValueError:
        return 'configerror'

    try:
        disk_fw_ver  = int(fw_str[2:4])
    except ValueError:
        return 'unknown'

    if disk_fw_ver < image_fw_ver:
        return 'needsupdate'
    else:
        return 'current'


###############################################################################
# fw_string_cmp_func_map
#
# dictionary that make a particular drive to a firmware comparison function.
#
###############################################################################
fw_string_cmp_func_map = {"ST3250310NS":seag_es2_cmp,
                          "ST3500320NS":seag_es2_cmp}
