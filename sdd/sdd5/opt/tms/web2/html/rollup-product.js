RBT.VE={};RBT.VE.daysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];RBT.VE.daysStrToNum=function(a,c){var b=[];Y.each(a.split(","),function(d){var e=Y.Array.indexOf(RBT.VE.daysShort,d);if(e>=0){b.push(e)}});return c?b:b.join(",")};RBT.VE.daysNumToStr=function(b){var a=[];Y.each(b.split(",").sort(Y.Array.numericSort),function(c){if(parseInt(c,10)<RBT.VE.daysShort.length){a.push(RBT.VE.daysShort[c])}});return a.join(",")};RBT.VE.hours=["12AM","1AM","2AM","3AM","4AM","5AM","6AM","7AM","8AM","9AM","10AM","11AM","12PM","1PM","2PM","3PM","4PM","5PM","6PM","7PM","8PM","9PM","10PM","11PM"];RBT.VE.everyhour="every hour";RBT.VE.hoursNumToStr=function(a){var b=[];Y.each(a.split(",").sort(Y.Array.numericSort),function(c){c=parseInt(c,10);if(c<RBT.VE.hours.length){b.push(RBT.VE.hours[c])}});if(b.length===RBT.VE.hours.length){return RBT.VE.everyhour}else{return b.join(",")}};RBT.VE.haInactive=function(){return !Y.Object.getValue(RBT.VE.edgeHAStatus,"isActive")};RBT.VE.setHAInactiveMsg=function(c){var d,b,a;d='<span title="This status indicator will only become available whenthis Granite Edge becomes Active">N/A</span>';b=Y.Node.create(d);a=new RBT.Tooltip({triggerNode:b}).render();c=Y.one(c);c.setContent(b);c.set("class","");c.addClass("failoverInactive")};RBT.VE.confirmRemove=function(g,e,c,a,b,f,d,h){b=Y.Lang.isArray(b)?b:[];return function(l,n,k){var i,j,m=k.getAttribute(c);if(m===h){return}i=document.createElement("a");i.setAttribute("href","");if(g){setElementClass(i,g)}i.onclick=function(){var p,t,s,r,o,q="";p={};p[e]=m;t=b.concat([p]);s="remove";if(Y.Lang.isString(f)){s=f}r=s.charAt(0).toUpperCase()+s.substr(1);if(Y.Lang.isFunction(d)){q=d.call(this,k)}else{if(Y.Lang.isString(d)){q=d}else{q="Are you sure you want to "+s.toLowerCase()+" "+m+"?"}}o=new RBT.Dialog({affinity:RBT.Dialog.AFFINITY_SE,alignNode:i,content:q,buttons:[{label:r,clickFn:function(){this.destroy();a.apply(this,t)}},{label:"Cancel",clickFn:RBT.Dialog.dismiss}]});o.render();return false};j=document.createElement("img");j.setAttribute("src","/images/icon_trash2.png");j.setAttribute("border","0");j.setAttribute("id",l.name+"_remove_"+m);i.appendChild(j);n.appendChild(i)}};RBT.VE.refreshLater=function(a){a=Y.Lang.isNumber(a)?a:5000;Y.later(a,null,function(){window.location.reload()})};RBT.VE.handleEnterKey=function(d,e,b,a,f){var c=Y.one(e);a=a||[];f=f||null;d.on("key",function(h){var g;h.preventDefault();if(c){RBT.Validator.validateForm(c);g=c.getData("RBT.Validator");if(g&&Y.Object.size(g.invalidFields)>0){return}}b.apply(f,a)},"down:13",Y)};RBT.VE.createActionDialog=function(g){var f,d,a,e,c={affinity:RBT.Dialog.AFFINITY_SW,actionButtonText:"Add",actionArgs:[],actionContext:null,cancelText:"Cancel"};Y.mix(c,g,true);function b(j){var i=d.get("actionFunc"),h=d.get("actionArgs"),k=d.get("actionContext");if(j){j.preventDefault()}d.hide();i.apply(k,h)}f=Y.Array({label:c.cancelText,clickFn:function(h){h.preventDefault();this.hide()}});if(Y.Lang.isString(c.actionButtonText)){f.unshift({label:c.actionButtonText,clickFn:b})}c.buttons=f;d=new RBT.Dialog(c).render();d.get("boundingBox").setStyle("zIndex",999);srcNode=Y.one(c.srcNode);if(Y.Lang.isString(c.actionButtonText)){srcNode.one('input[type=submit][value="'+c.actionButtonText+'"]').set("id",srcNode.get("id")+"_actionButton")}srcNode.one('input[type=submit][value="'+c.cancelText+'"]').set("id",srcNode.get("id")+"_cancelButton");if(c.actionFunc){d.set("actionFunc",c.actionFunc)}if(c.actionArgs){d.set("actionArgs",c.actionArgs)}if(c.actionContext){d.set("actionContext",c.actionContext)}if(Y.Lang.isString(c.actionButtonText)){a=d.get("contentBox").one('input[value="'+c.actionButtonText+'"]');e=a.get("form");if(e){RBT.Validator.addButtonValidation(a)}RBT.VE.handleEnterKey(d.get("contentBox").all("input[type=text], input[type=password]"),e,b)}return d};RBT.VE.showActionDialog=function(b,a){a=a||{};if(a.alignNode){b.set("alignNode",a.alignNode)}if(a.actionFunc){b.set("actionFunc",a.actionFunc)}if(a.actionArgs){b.set("actionArgs",a.actionArgs)}if(a.actionContext){b.set("actionContext",a.actionContext)}b.show();b.get("contentBox").one("input").focus()};RBT.VE.tdAttrStyle=function(a,b){return function(f,h,e){var g=e.getAttribute(a)||"",c=e.getAttribute(b)||"",d=Y.one(h);d.appendChild(Y.Node.create(g));d.addClass(c)}};RBT.VE.tdStatus=function(a){var c,d,b=Y.Array(arguments);b.shift();c=a.apply(this,b);d=function(f,g,e){RBT.VE.setHAInactiveMsg(g)};return function(){if(RBT.VE.haInactive()){d.apply(this,arguments)}else{c.apply(this,arguments)}}};RBT.VE.ajaxSubmit=function(e){var a,b,g,d,k,h={url:"/mgmt/xmldata",httpMethod:"POST",callbackArgs:[],liveStatWait:1000,sync:false};Y.mix(h,e,true);h.formEl=Y.one(h.formEl);if(h.liveStat){if(h.sync){h.liveStat.show(h.liveStatMsg,false)}else{a=Y.later(h.liveStatWait,h.liveStat,h.liveStat.show,[h.liveStatMsg,false])}}b={method:h.httpMethod,sync:h.sync,on:{success:h.respMethod?i:j,failure:f}};g=h.data||{};if(h.formEl){d=collectFormFields(h.formEl,null);Y.mix(g,d,false)}g=l(g,"arg_");b.data=g;k=Y.io(h.url+"?p="+h.reqMethod,b);RBT.VE.openAjaxRequests.push(k);function i(q,m){var n,o,p=m.responseXML.documentElement;if("xml"===p.tagName){p=p.firstChild}if(c(p)){return}n=p.firstChild;o={method:h.httpMethod,sync:h.sync,data:{arg_request_id:n.getAttribute("request_id")},on:{success:j,failure:f},"arguments":p};k=Y.io(h.url+"?p="+h.respMethod,o);RBT.VE.openAjaxRequests.push(k)}function j(q,n,o){var p,m=n.responseXML.documentElement;if("xml"===m.tagName){m=m.firstChild}if(c(m)){return}if(h.liveStat){if(a){a.cancel()}h.liveStat.hide(true)}if(Y.Lang.isFunction(h.onSuccess)){if(o){p=[o,m].concat(h.callbackArgs)}else{p=[m].concat(h.callbackArgs)}h.onSuccess.apply(this,p)}}function f(n,m){if(h.liveStat){if(a){a.cancel()}h.liveStat.show("Data submission failed: "+m.statusText+" ("+m.status+")",true)}}function c(n){var o,m="An Error Occured.";if(n.nodeName==="error"){m=n.firstChild.data}else{if(n.getAttribute("status")==="fail"){m=n.getAttribute("errorMsg")}else{if(n.nodeName==="result"&&n.firstChild.nodeName==="response"){if(n.firstChild.getAttribute("status")==="success"){return false}else{m=n.firstChild.getAttribute("errorMsg")||"An unknown error occured."}}else{m="Unknown XML response from device: "+n.nodeName}}}if(h.liveStat){if(a){a.cancel()}h.liveStat.show(m,true)}if(h.onFailure){o=[n].concat(h.callbackArgs);h.onFailure.apply(this,o)}return true}function l(o,m){var n={};Y.Object.each(o,function(q,p){n[m+p]=q});return n}};RBT.VE.openAjaxRequests=[];RBT.VE.openAjax=function(){var a=Y.Array.find(RBT.VE.openAjaxRequests,function(b){return b.isInProgress()});return a!==null};RBT.VE.reloadPage=function(a){var b=false;try{b=a.firstChild.getAttribute("_msg")}catch(c){}if(b){window.location=addQueryStringParameter(window.location.toString(),"_msg",b)}else{window.location.reload(true)}};RBT.VE.validateEdgeIdentifier=function(a){if(!a.match(/^[\.0-9a-zA-Z:\-]{3,}$/)){throw'Granite Edge Identifiers should have 3 or more characters and may only contain letters, numbers, dashes ("-"), periods (".") and colons (":")'}};RBT.VE.validateFirstIP=function(a){RBT.Validator.Syntax.ipv4addr(a);if(Y.one("input[name=second_peer_ip]").get("value")===a){throw"First and second Peer IP addresses must be different."}};RBT.VE.validateSecondIP=function(a){RBT.Validator.Syntax.ipv4addr(a);if(Y.one("input[name=peer_ip]").get("value")===a){throw"First and second Peer IP addresses must be different."}};RBT.VE.fillDiv=function(f,a,d,e){var c,b;d=Y.Lang.isString(d)?d:"name";f=Y.one(f);a=Y.Array(a);e=e||"None";f.setContent("");if(a.length===0){c="<span>"+e+"</span></br>";b=Y.Node.create(c);f.appendChild(b)}else{Y.each(a,function(h){var g;if(h instanceof Y.Node){g=h.get(d)}else{g=h.getAttribute(d)}c="<span>"+g+"</span></br>";b=Y.Node.create(c);f.appendChild(b)})}};RBT.VE.fillSelect=function(d,a,f,g,e){var c,b;f=Y.Lang.isNumber(f)?f:40;d=Y.one(d);d.get("options").remove();if(g){d.appendChild('<option title="'+g+'" value="">'+g+"</option>")}Y.each(a,function(h){c=Y.substitute('<option title="{optTitle}" value="{optVal}">{optText}</option>',{optText:RBT.VE.ellipsize(h[1],f),optVal:h[0],optTitle:h[1]});b=Y.Node.create(c);if(h.length>2&&h[2]===false){b.set("disabled",true)}d.appendChild(b)});if(d.get("options").size()===0){c=Y.substitute('<option title="{optTitle}" value="">{optTitle}</option>',{optTitle:e||"None"});b=Y.Node.create(c);b.set("disabled",true);d.appendChild(b)}};RBT.VE.ellipsize=function(d,a,c){var b=0,e=0;d=String(d);if(!a||Number(a)===0){a=50}if(d.length<=a){return d}if(!c){c="..."}b=Math.max(a-c.length,2);e=b/2;return d.slice(0,e)+c+d.slice(-e)};RBT.VE.updateConfig=function(a,b){var c=!a.isCMC&&b.isActive;if(!a.edgeLaunched){if(!RBT.VE.openAjax()){window.location.reload(true)}return}Y.one("#dvaHostnameSpan").setContent(a.dva);Y.one("#dvaIPAddress").setContent(a.dvaAddr);Y.one("#dvaPort").setContent(a.port);Y.one("#dvaSelfIdentifier").setContent(a.identifier);Y.one("#dvaPort").setContent(a.port);if(c){Y.one("#editCoreLink").show()}else{Y.one("#editCoreLink").hide()}if(b.peerAddress!==""){Y.one("#edgeHARows").show();Y.one("#edgeHAPeer").setContent(b.peerAddress);if(b.role==="Unknown"){Y.one("#edgeHARoleRow").hide()}else{Y.one("#edgeHARoleRow").show();Y.one("#edgeHARole").setContent(b.role)}}else{Y.one("#edgeHARows").hide()}if(a.dvaFailoverPeerAddr!==""){Y.one("#dvaFailoverRows").show();Y.one("#dvaFailoverPeerAddr").setContent(a.dvaFailoverPeerAddr);Y.one("#dvaFailoverPeerPort").setContent(a.dvaFailoverPeerPort);Y.one("#dvaFailoverActivePeer").setContent(a.dvaFailoverActivePeer);if(a.dvaFailoverPeerIps.length>0){Y.one("#dvaFailoverPeerIpsRow").show();Y.one("#dvaFailoverPeerIps").setContent(a.dvaFailoverPeerIps.join("<br />"))}else{Y.one("#dvaFailoverPeerIpsRow").hide()}}else{Y.one("#dvaFailoverRows").hide()}if(!a.isCMC){if(b.peerAddress===""){Y.one("#haClearPeerBtn").hide();Y.one("#removeDVAPeerBtn").set("disabled",!c)}else{Y.one("#haClearPeerBtn").show();Y.one("#removeDVAPeerBtn").set("disabled",true)}}else{Y.one("#haClearPeerBtn").hide();Y.one("#removeDVAPeerBtn").hide()}if(a.redundantWANSupport){Y.one("#redundantWANRow").show();dcHostnameAddRemoveList.set("showControls",c);dcHostnameAddRemoveList.render()}else{Y.one("#redundantWANRow").hide()}dcLocalIntfAddRemoveList.set("showControls",c);dcLocalIntfAddRemoveList.render()};RBT.VE.updateConnStatus=function(g,h,c){var n="",k="",b="connStatus_",q=Y.one("#dvaConnImg"),j=Y.one("#dvaConnDiv"),f=Y.one("#dvaInfoDiv"),e="evaCoreStatus_",d=Y.one("#evaCoreConnDiv"),p="evaCoreFailoverStatus_",l=Y.one("#evaCoreFailoverConnDiv");Y.one("#dvaConnectivity").show();b+=(h.dvaFailoverPeerAddr!==""?"t":"f");b+=(c.peerAddress!==""?"t":"f");e+=(g.mgmtConnected?"t":"f");e+=(g.lunsConnected?"t":"f");p+=(h.dvaFailoverPeerAddr!==""?"t":"f");p+="_"+(g.mgmtConnected?"t":"f");p+=(g.lunsConnected?"t":"f");p+=(g.failoverEnabled?"t":"f");p+=(g.peerConnected?"t":"f");p+=(g.failoverActive?"t":"f");if(g.failoverActive){if(g.peerConnected){n="Not Connected to Granite Core<br />Connected to Failover Granite Core";k="Not Connected to Granite Core, Connected to Failover Granite Core"}else{n="No Granite Core Connection";k="No Granite Core Connection"}}else{if(g.mgmtConnected){n="Connected to Granite Core";k="Connected to Granite Core"}else{n="Not Connected to Granite Core";k="Not Connected to Granite Core"}if(g.failoverEnabled){if(g.peerConnected){n+="<br /> Failover Granite Core ready";k+=", Failover Granite Core ready"}else{n+="<br /> Failover Granite Core Not ready";k+=", Failover Granite Core Not ready"}}}if(!g.lunsConnected){n+='<br />(<a href="#" onclick="return branchRadioTab.switchTo(\'luns\');">LUNs Not Connected</a>)';k+=", but some LUNs not connected"}j.setContent(n);q.set("title",k);q.setAttribute("alt",k);q.setAttribute("class","");q.addClass(b);f.setAttribute("class","");f.addClass(b);d.setAttribute("class","");d.addClass(e);l.setAttribute("class","");l.addClass(p);var a=Y.one("#edgeHAStatus"),m=Y.one("#edgeHAHeartbeats"),i=Y.one("#edgeHAState"),o='<table class="edgeHAHBTable">';RBT.VE.edgeHAStatus=c;if(c.peerAddress===""){a.setStyle("visibility","hidden");return}a.setStyle("visibility","visible");i.setContent(c.stateString);i.setAttribute("class","").addClass(c.stateClass);m.setContent("");Y.each(c.heartbeats,function(r,t){var u='<tr><td class="source">{srcIP} </td><td title="{title}"><span class="{cls}"></span></td><td class="dest"> {destIP}</td></tr>',v=Y.Object.keys(r.local_addr)[0],s=Y.Object.keys(r.conn_state)[0]==="true";o+=Y.substitute(u,{srcIP:v,destIP:t,title:s?"Connected":"Not Connected",cls:s?"haSuccessImg":"haErrorImg"})});o+="</table>";m.appendChild(o)};RBT.VE.PlaceKeeper=function(){var a=Y.QueryString.parse(window.location.search.substr(1));this.delim="|||";this.activetable="activetable";this.page=a.p};RBT.VE.PlaceKeeper.prototype.getSaved=function(){return Y.Cookie.getSubs(this.page)};RBT.VE.PlaceKeeper.prototype.openTab=function(a){var b=this.getSaved();if(Y.Object.hasKey(b,a.name)){a.switchTo(b[a.name])}};RBT.VE.PlaceKeeper.prototype.openTable=function(e,c,a){var d,b;if(e.editAfterLoad!==null){return}d=this.getSaved();if(a&&Y.Object.hasKey(d,this.activetable)&&d[this.activetable]!==e.name){return}if(Y.Object.hasKey(d,e.name+this.delim+c)){b=d[e.name+this.delim+c];e.editAfterLoad=[c,b]}};RBT.VE.PlaceKeeper.prototype.saveRow=function(c,b,a){Y.Cookie.setSub(this.page,c.name+this.delim+b,a);Y.Cookie.setSub(this.page,this.activetable,c.name);c.editAfterLoad=[b,a]};RBT.VE.PlaceKeeper.prototype.removeRow=function(b,a){Y.Cookie.setSub(this.page,b.name+this.delim+a,"")};RBT.VE.PlaceKeeper.prototype.saveTab=function(b,a){Y.Cookie.setSub(this.page,b.name,a)};RBT.VE.placeKeeper=new RBT.VE.PlaceKeeper();RadioTabControl.prototype.setupPlaceKeeper=function(){Y.each(this.tabs,function(b){var a="#"+this.name+"_"+b[0]+"_title";Y.one(a).on("click",function(){RBT.VE.placeKeeper.saveTab(this,b[0])},this)},this);onloadScript+=" RBT.VE.placeKeeper.openTab("+this.name+");"};AjaxEntryTable.prototype.veRefresh=function(){this.setEditMode(false);this.sendRequest(this.url)};RBT.Reports={};RBT.Reports.HC={};RBT.Reports.HC.DEFAULT_DATA_URL="/mgmt/jsondata";RBT.Reports.HC.DEFAULT_OPTIONS={HC:{colors:["#F57900","#5a5a5a","#227cd8","#5B0366","#00053E","#0431D4","#FE2520","#5502D1","#1DB205","#de2b26","#A24B03","#1F77FC","#24CBE5","#6B6A70","#85DE03","#FDD55B","#F603BB","#500302"],chart:{defaultSeriesType:"line",showAxes:true,zoomType:"x",spacingLeft:20,spacingRight:40,spacingTop:25,spacingBottom:30,borderRadius:9,borderWidth:1,borderColor:"#cfcfcf",backgroundColor:{linearGradient:[0,0,0,400],stops:[[0,"rgba(44,44,46,0.07)"],[1,"rgba(44,44,46,0.21)"]]},style:{fontFamily:"Verdana, sans-serif",position:"relative"},events:{}},global:{useUTC:true},title:{text:null,margin:30,style:{fontSize:"15px",color:"#555555"}},subtitle:{y:35,style:{fontSize:"13px",color:"#555555"}},xAxis:{type:"datetime",dateTimeLabelFormats:{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%m/%e",week:"%m/%e",month:"%m/%Y",year:"%Y"},lineColor:"#b1b1b1"},yAxis:{allowDecimals:false,showFirstLabel:false,title:{text:null,margin:20,style:{color:"#616161"}},gridLineColor:"#c7c7c7",min:0},tooltip:{enabled:true,shared:true,style:{padding:"5px"}},legend:{borderWidth:0,align:"center",verticalAlign:"bottom",y:0,margin:20,floating:false,enabled:true,itemStyle:{color:"#515151"},itemHiddenStyle:{color:"#a3a3a3"}},loading:{style:{opacity:0.4}},series:[],credits:{enabled:false},plotOptions:{area:{fillColor:{linearGradient:[0,0,0,300],stops:[[0,"rgba(245,121,0,1)"],[1,"rgba(245,121,0,0.25)"]]},lineWidth:1,marker:{enabled:false,states:{hover:{enabled:true,radius:5}}},shadow:false,states:{hover:{lineWidth:1}}},line:{shadow:false,marker:{enabled:true,radius:1,symbol:"square"},lineWidth:1.3,states:{hover:{lineWidth:1.3}}},pie:{allowPointSelect:false,cursor:"pointer",size:"103%",center:["53%","54%"],dataLabels:{enabled:false},shadow:false}}},RBT:{yAxis:{numTicks:5,base2:false},summary:{paddingLeft:35,paddingRight:35,paddingTop:25,paddingBottom:25,columnWidth:100,summaryWidth:840,borderRadius:9,backgroundColor:"rgba(44,44,46,0.21)",textPadding:5,fontColor:"#585C65",style:{color:"#585C65"},stroke:"#bfbfbf",strokeWidth:1}}};RBT.Reports.HC.LINE_OPTIONS_THUMB={HC:{colors:["#828282"],chart:{defaultSeriesType:"line",showAxes:true,zoomType:"",spacingLeft:20,spacingRight:20,spacingTop:15,spacingBottom:22,borderRadius:9,borderWidth:1,backgroundColor:"#e8e8e8",borderColor:"#c0c0c0",style:{fontFamily:"Verdana, sans-serif",position:"relative"},events:{}},title:{text:null,align:"center",margin:15,x:0,style:{fontSize:"13px",color:"#909090"}},xAxis:{labels:{enabled:false},tickWidth:0,lineWidth:0},yAxis:{title:{text:null,style:{color:"#676A71"}},maxPadding:0,minPadding:0,labels:{enabled:false},min:0,gridLineWidth:0},legend:{enabled:false},tooltip:{enabled:false},plotOptions:{area:{fillColor:{linearGradient:[0,0,0,95],stops:[[0,"rgba(120,120,120,1)"],[1,"rgba(120,120,120,0.15)"]]},lineWidth:1,marker:{enabled:false},shadow:false,states:{hover:{lineWidth:1}}},line:{lineWidth:1,shadow:false,states:{hover:{lineWidth:1}},marker:{enabled:false}}}},RBT:{}};RBT.Reports.HC.PIE_OPTIONS_HOME={HC:{colors:["#f57900","#fe9f52","#fe8a2d","#fd7202","#cd5d02","#af5003","#883d00","#999999","#888888","#777777","#666666","#555555","#444444","#333333"],chart:{defaultSeriesType:"pie",showAxes:false,zoomType:"",spacingLeft:20,spacingRight:40,spacingTop:20,spacingBottom:30,borderRadius:9,borderWidth:1,borderColor:"#cfcfcf",backgroundColor:{linearGradient:[0,0,0,400],stops:[[0,"rgba(44,44,46,0.07)"],[1,"rgba(44,44,46,0.21)"]]},style:{fontFamily:"Verdana, sans-serif",position:"relative"},events:{}},title:{margin:30,style:{fontSize:"14px",color:"#555555"}},subtitle:{y:34,style:{fontSize:"11px",color:"#888888"}},tooltip:{enabled:true,shared:false,style:{padding:"5px"}},plotOptions:{pie:{allowPointSelect:false,cursor:"pointer",size:"103%",center:["53%","54%"],dataLabels:{enabled:false},shadow:false,point:{events:{click:function(){if(this.series.name==="edgePie"){if(this.name==="Unmapped Storage"){window.location="/mgmt/gui?p=setupLUNs"}else{if(this.name==="All Other Edges"){window.location="/mgmt/gui?p=setupEVAs"}else{window.location="/mgmt/gui?p=setupEVAs&identifier="+this.name}}}else{if(this.series.name==="portalPie"){window.location="/mgmt/gui?p=setupLUNs"}}}}}}}},RBT:{}};RBT.Reports.HC.SummaryTable=function(c){var e,a,b,d=Y.clone(RBT.Reports.HC.DEFAULT_OPTIONS.RBT.summary);if(c){Y.mix(d,c,true)}e=Y.one("#"+d.renderTo);a=new Highcharts.Renderer(e,0,0);a.boxWrapper.css({position:"relative"});b=a.g().add();this.setData=function(j){var g,i,l=0,f=d.paddingLeft,k=d.paddingTop,h=j.summary;if(!h){return}b.empty();Y.each(h.data,function(n,m){var o;Y.each(h.columns,function(q,p){var r=a.text(n[q],f,k);r.attr({zIndex:5,id:d.renderTo+"_"+m+"_"+p});r.css(d.style);r.add(b);o=r.getBBox();if(o.width==0){o.width=50}if(o.height==0){o.height=15}if(p===h.columns.length-1){r.attr({x:d.summaryWidth-d.paddingRight-o.width})}f+=d.columnWidth});f=d.paddingLeft;if(o){l=o.height;k+=l;if(m<h.data.length-1){k+=d.textPadding}}});g=k;i=a.rect(0,0,d.summaryWidth,g,d.borderRadius);i.attr({fill:d.backgroundColor,stroke:d.stroke,"stroke-width":d.strokeWidth,zIndex:4});i.add(b);a.setSize(d.summaryWidth,g,false)};this.destroy=function(){var f=e&&e.parentNode;b.destroy();e.setContent("");if(f){f.removeChild(e)}e=null;a.alignedObjects=null}};RBT.Reports.HC.heir=function(b){function a(){}a.prototype=b;return new a()};RBT.Reports.HC.Chart=function(c,d,a,b){this.dataURL=d;this.queryParams=Y.clone(a);this.optionsRBT=Y.clone(c.RBT);if(b){this.setID=b}c.HC.chart.events.load=function(){var e=Y.clone(c.RBT.summary);e.summaryWidth=this.chartWidth;this.summaryTable=new RBT.Reports.HC.SummaryTable(e);jQuery(this).bind("destroy",this.summaryTable.destroy)};c.HC.chart.events.selection=function(f){var h,g,e,i;if(f.xAxis){h=f.xAxis[0];g=this.convertTime(Math.round(h.min));e=this.convertTime(Math.round(h.max));i=this.queryParams;Y.mix(i,{lb:g,ub:e,per:"cust"},true);this.zoomed=true;this.showLoading();RBT.Reports.HC._getData(this.dataURL,i,false,this.processZoomData,function(){this.hideLoading()},this);return false}};Highcharts.Chart.call(this,c.HC)};RBT.Reports.HC.Chart.prototype=RBT.Reports.HC.heir(Highcharts.Chart.prototype);RBT.Reports.HC.Chart.prototype.processData=function(a){this.savedData=a;if(Y.Object.hasKey(a,"range")){this.xAxis[0].setExtremes(a.range.lbt,a.range.ubt,false);this.setTitle({},{text:a.range.lb+" - "+a.range.ub})}if(this.summaryTable){this.summaryTable.setData(a)}Y.each(a.series,function(c){this.addSeries(c,false)},this);this.redraw(false);if(this.optionsRBT.yAxis.base2){var b=this.yAxis[0].getExtremes().dataMax;if(Y.Lang.isValue(b)){this.yAxis[0].options.tickInterval=RBT.Reports.HC.getBase2Interval(b,this.optionsRBT.yAxis.numTicks);this.yAxis[0].setExtremes(null,null);this.redraw(false)}}this.hideLoading()};RBT.Reports.HC.Chart.prototype.updateData=function(a){if(Y.Object.hasKey(a,"range")){this.xAxis[0].setExtremes(a.range.lbt,a.range.ubt,false);this.setTitle({},{text:a.range.lb+" - "+a.range.ub})}Y.each(this.series,function(d,c){if(a.series[c]){d.setData(a.series[c].data,false)}});this.redraw(false);if(this.summaryTable){this.summaryTable.setData(a)}if(this.optionsRBT.yAxis.base2){var b=this.yAxis[0].getExtremes().dataMax;if(Y.Lang.isValue(b)){this.yAxis[0].options.tickInterval=RBT.Reports.HC.getBase2Interval(b,this.optionsRBT.yAxis.numTicks);this.yAxis[0].setExtremes(null,null);this.redraw(false)}}};RBT.Reports.HC.Chart.prototype.processZoomData=function(a){this.updateData(a);if(this.resetButton){this.resetButton.remove()}this.resetButton=jQuery("<div>Reset Zoom</div>").css({cursor:"pointer",color:"#F57900",position:"absolute",top:"60px",right:"40px",zIndex:50}).click(this,function(c){var b=c.data;b.updateData(b.savedData);if(b.resetButton){b.resetButton.remove()}b.zoomed=false}).appendTo(this.container);this.hideLoading()};RBT.Reports.HC.Chart.prototype.convertTime=function(a){var b=new Date(a);return b.getUTCFullYear()+"/"+((b.getUTCMonth()+1)<10?"0":"")+(b.getUTCMonth()+1)+"/"+(b.getUTCDate()<10?"0":"")+b.getUTCDate()+" "+(b.getUTCHours()<10?"0":"")+b.getUTCHours()+":"+(b.getUTCMinutes()<10?"0":"")+b.getUTCMinutes()+":"+(b.getUTCSeconds()<10?"0":"")+b.getUTCSeconds()};RBT.Reports.HC.Thumb=function(b,a){if(a){this.setID=a}b.HC.chart.events.load=function(){this.overlay=this.renderer.rect(0,0,this.chartWidth-1,this.chartHeight-1,b.HC.chart.borderRadius);this.overlay.attr({fill:{linearGradient:[0,0,0,300],stops:[[0,"rgba(96, 96, 96, 0.05)"],[1,"rgba(16, 16, 16, 0.3)"]]},"stroke-width":0,stroke:"#CFCFCF"});this.overlay.add();this.overlay.hide();Y.one(this.container).on("mouseover",function(){this.overlay.show()},this);Y.one(this.container).on("mouseout",function(){this.overlay.hide()},this);this.border=this.renderer.rect(1,1,this.chartWidth-2,this.chartHeight-2,b.HC.chart.borderRadius);this.border.attr({fill:{linearGradient:[0,0,0,145],stops:[[0,"rgba(255,230,190,1)"],[1,"rgba(251,174,86,1)"]]},"stroke-width":1.5,stroke:"#f57900"});this.border.add();this.border.hide()};Highcharts.Chart.call(this,b.HC)};RBT.Reports.HC.Thumb.prototype=RBT.Reports.HC.heir(Highcharts.Chart.prototype);RBT.Reports.HC.Thumb.prototype.select=function(){this.selected=true;this.border.show();this.setTitle({style:{color:"#717171",fontSize:"12px",fontWeight:"bold"}});Y.each(this.series,function(a){if(a.graph){a.graph.attr({stroke:"#6f6f6f"});a.redraw()}});placeKeeper.saveReportSelected(this.setID)};RBT.Reports.HC.Thumb.prototype.deselect=function(){this.selected=false;this.border.hide();this.setTitle({style:{color:"#888888"}});Y.each(this.series,function(a){if(a.graph){a.graph.attr({stroke:"#888888"});a.redraw()}})};RBT.Reports.HC.Thumb.prototype.processData=function(a){this.xAxis[0].setExtremes(a.range.lbt,a.range.ubt,false);Y.each(a.series,function(c,b){var d=Y.clone(c);if(this.selected){d.color="#717171"}else{d.color="#888888"}if(this.series[b]){this.series[b].setData(c.data,true)}else{this.addSeries(d,true)}},this);this.hideLoading()};RBT.Reports.HC._getData=function(c,i,h,a,b,f){var g,e;f=f||this;function j(n,k){var m;try{m=Y.JSON.parse(k.responseText)}catch(l){if(!k){alert("No response received.")}else{alert("Unable to parse response: "+k.responseText)}if(b){b.call(f)}}if(m.success){g=m.response;if(a){a.call(f,g)}}else{alert(m.errorMsg);if(b){b.call(f)}}}function d(l,k){if(b){b.call(f)}}e={sync:h,on:{success:j,failure:d},data:i};Y.io(c,e);return g};RBT.Reports.HC.scale=function(d,c){var a,b;if(d<=0){return d+" "+c[0][2]}else{for(a=0;a<c.length-1;a+=1){if(d<=c[a+1][1]){break}}b=d/c[a][0];if(b%1!=0){return b.toFixed(2)+" "+c[a][2]}else{return b+" "+c[a][2]}}};RBT.Reports.HC.getBase2Interval=function(e,g){var c,b=e/g,a=Math.pow(2,Math.floor(Math.log(b)/Math.LN2)),f=b/a,d=[1,2,2.5,5];for(c=0;c<d.length;c++){b=d[c];if(f<=(d[c]+(d[c+1]||d[c]))/2){break}}return b*a};RBT.Reports.HC.GraphSet=function(d,b,a,c,f){this.id=c.id;this.graphId=c.graphContainer||c.id+"Graph";this.summaryId=c.summaryContainer||this.graphId+"_summary";this.thumbId=c.thumbContainer||this.graphId+"_mini";this.dataURL=d||RBT.Reports.HC.DEFAULT_DATA_URL;this.options=Y.clone(RBT.Reports.HC.DEFAULT_OPTIONS);this.queryParams=Y.clone(b);if(Y.Object.hasKey(c,"optionSet")){Y.mix(this.options.HC,RBT.Reports.HC[c.optionSet].HC,true);Y.mix(this.options.RBT,RBT.Reports.HC[c.optionSet].RBT,true)}this.options.HC.chart.renderTo=this.graphId;this.options.RBT.summary.renderTo=this.summaryId;this.options.HC.title.text=c.title||"";this.options.HC.subtitle.text=c.subtitle||(this.queryParams.lb+" - "+this.queryParams.ub);Y.mix(this.options.HC.xAxis,a,true);this.options.HC.yAxis.title.text=c.ylabel||"";this.options.RBT.yAxis.base2=c.base2||false;function e(g,h){return function(){var i="";if(this.points){if(g.HC.xAxis.type==="datetime"){i+=Highcharts.dateFormat("%B %e %Y %H:%M:%S",this.x)}else{i+=RBT.VE.ellipsize(this.x,30,"...")}Y.each(this.points,function(j){i+="<br/>"+j.series.name+": "+RBT.Reports.HC.scale(j.y,h)})}else{if(this.point.name){i+="<b>"+RBT.VE.ellipsize(this.point.name,30,"...")+"</b>"}else{if(g.HC.xAxis.type==="datetime"){i+=Highcharts.dateFormat("%B %e %Y %H:%M:%S",this.x)}else{i+=RBT.VE.ellipsize(this.x,30,"...")}}i+="<br/>"+RBT.Reports.HC.scale(this.y,h);if(this.percentage){i+="<br/>("+Highcharts.numberFormat(this.percentage,1)+"%)"}}return i}}if(this.options.HC.tooltip.enabled){if(Y.Object.hasKey(c,"scale")){this.options.HC.tooltip.formatter=e(this.options,c.scale)}}this.options.HC.yAxis.labels={formatter:function(){return RBT.Reports.HC.scale(this.value,c.scale)}};this.chart=new RBT.Reports.HC.Chart(this.options,this.dataURL,this.queryParams,this.id);if(this.chart.hasRendered){this.chart.showLoading()}if(f){this.thumbOptions=Y.clone(RBT.Reports.HC.DEFAULT_OPTIONS);Y.mix(this.thumbOptions.HC,RBT.Reports.HC.LINE_OPTIONS_THUMB.HC,true);this.thumbOptions.HC.chart.renderTo=this.thumbId;this.thumbOptions.HC.title.text=c.title||"";Y.mix(this.thumbOptions.HC.xAxis,a,true);this.thumb=new RBT.Reports.HC.Thumb(this.thumbOptions,this.id);if(this.thumb.hasRendered){this.thumb.showLoading()}}this.update(null)};RBT.Reports.HC.GraphSet.prototype.processData=function(a){function b(){var c=this;if(!this.chart.hasRendered&&document.attachEvent){document.attachEvent("onreadystatechange",function(){document.detachEvent("onreadystatechange",b);b.call(c)});return}if(this.chart.series.length===0){this.chart.processData(a)}else{if(!this.chart.zoomed){this.chart.updateData(a)}this.chart.savedData=Y.clone(a)}if(Y.Lang.isObject(this.thumb)){this.thumb.processData(a)}}b.call(this)};RBT.Reports.HC.GraphSet.prototype.processFailure=function(){if(this.chart.hasRendered){this.chart.hideLoading()}if(Y.Lang.isObject(this.thumb)){if(this.thumb.hasRendered){this.thumb.hideLoading()}}};RBT.Reports.HC.GraphSet.prototype.update=function(a){if(Y.Lang.isObject(a)){Y.mix(this.queryParams,a,true)}RBT.Reports.HC._getData(this.dataURL,this.queryParams,false,this.processData,this.processFailure,this);if(Y.Lang.isObject(this.refresher)){this.refresher.cancel()}if(window.location.search.indexOf("dynstatus=off")>-1){return}else{if(parseInt(this.queryParams.refresh,10)>0){this.refresher=Y.later(parseInt(this.queryParams.refresh,10),this,RBT.Reports.HC._getData,[this.dataURL,this.queryParams,false,this.processData,this.processFailure],true)}}};RBT.Reports.HC.GraphSet.prototype.destroy=function(){if(this.chart){this.chart.destroy();this.chart=null}if(this.thumb){this.thumb.destroy();this.thumb=null}if(this.refresher){this.refresher.cancel();this.refresher=null}};RBT.Reports.HC.generateGraphs=function(d){var a={};function c(){var e=placeKeeper.getReportSelected(),f=false;try{if(a[e]){Y.one("#"+e).setStyle("position","static");a[e].thumb.select();f=true}}catch(g){}Y.each(a,function(i,h){if(!f){Y.one("#"+h).setStyle("position","static");i.thumb.select();f=true}else{if(h!==e){Y.one("#"+h).setStyle("position","absolute");i.thumb.deselect()}}});Y.one("#miniContainer").setStyle("position","static");placeKeeper.saveReportView("dash")}function b(){Y.one("#miniContainer").setStyle("position","absolute");Y.each(a,function(f,e){Y.one("#"+e).setStyle("position","static")});placeKeeper.saveReportView("full")}Y.Array.each(d.graphs,function(f){var e=Y.clone(d.params);e.params.p=f.p||f.id;a[f.id]=new RBT.Reports.HC.GraphSet(d.url,e.params,e.range,f,d.dashboard)});if(d.dashboard){Y.on("click",c,"#dashboardView");Y.on("click",b,"#fullView");Y.on("load",function(){Y.each(a,function(f,e){Y.on("click",function(){Y.each(a,function(h,g){if(e===g){Y.one("#"+g).setStyle("position","static");h.thumb.select()}else{Y.one("#"+g).setStyle("position","absolute");h.thumb.deselect()}});Y.one("#miniContainer").focus()},f.thumb.container)});if(placeKeeper.getReportView()==="full"){b()}else{c()}})}return a};RBT.VE.AddRemoveList=function(a){RBT.VE.AddRemoveList.superclass.constructor.apply(this,arguments)};RBT.VE.AddRemoveList.NAME="addremovelist";RBT.VE.AddRemoveList.ATTRS={containerNode:{setter:Y.one},addDialogNode:{setter:Y.one},addMethod:{validator:Y.Lang.isString},removeDialogNode:{setter:Y.one},removeMethod:{validator:Y.Lang.isString},respMethod:{value:"veWaitForResponse",validator:Y.Lang.isString},contentURL:{validator:Y.Lang.isString},contentArray:{value:[],validator:Y.Lang.isArray},optionArray:{value:[],validator:Y.Lang.isArray},isPulldown:{validator:Y.Lang.isBoolean},liveStat:{},showControls:{value:true,validator:Y.Lang.isBoolean},refreshOnInit:{value:true,validator:Y.Lang.isBoolean},objectName:{value:"",validator:Y.Lang.isString},removeImg:{value:"/images/aet_edit_close.png"},afterRefreshFn:{validator:Y.Lang.isFunction},afterRefreshCtxt:{value:null},afterRefreshArgs:{value:[]}};Y.extend(RBT.VE.AddRemoveList,Y.Base,{initializer:function(){var a=this.get("containerNode"),b=this.get("refreshOnInit");a.addClass(this.getClassName("container"));this.createRemoveDialog();this.createAddDialog();if(b){this.refresh()}},destructor:function(){},getClassName:function(){return"rbt-addremovelist-"+Y.Array(arguments).join("-")},render:function(){var c,b,a=this.get("containerNode"),d=this.get("contentArray"),f=this.get("objectName"),e=this.get("showControls");a.setContent("");Y.each(d,function(h){var g=this.get("removeImg");if(e){b='<a href="#" id="{id}"><img src="{removeImg}" class="{imgCls}"/></a>{displayText}<br />'}else{b="{displayText}<br />"}c=Y.Node.create(Y.substitute(b,{displayText:h[1],removeImg:g,imgCls:this.getClassName("remove-image"),id:"remove"+f.replace(/[^a-zA-Z0-9]+/g,"")+"_"+h[0]}));if(e){c.one("a").on("click",function(i){i.preventDefault();this.showRemoveDialog(h)},this)}a.append(c)},this);if(d.length===0){a.append(Y.Node.create(Y.substitute('<span class="{cls}">(none)</span><br />',{cls:this.getClassName("grey")})))}if(e){b='<a href="#" class="{cls}">Add {objectName}</a>';c=Y.Node.create(Y.substitute(b,{objectName:f,cls:this.getClassName("add-link")}));c.on("click",function(h){var g=this.get("addDialog");h.preventDefault();RBT.VE.showActionDialog(g)},this);a.append(c)}this.updateAddDialog()},refresh:function(e){var c,h=this,f=this.get("isPulldown"),i=this.get("contentURL"),g=i.indexOf("?")===-1?"?":"&",d=this.get("afterRefreshFn"),a=this.get("afterRefreshCtxt"),b=this.get("afterRefreshArgs");if(Y.Lang.isString(e)){i+=g+e}RBT.rpc({url:i,successFn:function(j){var k;if(!Y.Lang.isArray(j)||(j.length&&!Y.Lang.isArray(j[0]))||(f&&j.length<2)){alert("Add/Remove: Appliance JSON response error");return}if(f){h.set("contentArray",j[0]);h.set("optionArray",j[1])}else{h.set("contentArray",j)}if(Y.Lang.isFunction(d)){k=[j].concat(b);d.apply(a,k)}h.render()}})},createAddDialog:function(){var d,b=this.get("containerNode"),c=this.get("addDialogNode"),e=c.one("input, select").get("form"),f=this.get("addMethod"),g=this.get("respMethod"),h=this.get("objectName"),a=this.get("liveStat");this.set("addFormNode",e);c.addClass(this.getClassName("dialog-contents"));d=RBT.VE.createActionDialog({srcNode:c,alignNode:b,actionFunc:RBT.VE.ajaxSubmit,actionButtonText:"Add "+h,actionArgs:Y.Array({formEl:e,reqMethod:f,respMethod:g,liveStat:a,liveStatMsg:"Adding "+h+"...",onSuccess:Y.bind(this.refresh,this)})});this.set("addDialog",d)},updateAddDialog:function(){var a=this.get("addFormNode"),b=this.get("addDialogNode"),g=b.one("."+this.getClassName("dialog-content")),i=b.one("."+this.getClassName("empty-message")),h=a.all("input.yui3-dialog-button"),e=h.item(0),d=h.item(1),c=this.get("optionArray"),f=this.get("isPulldown");if(f){if(c.length===0){e.hide();d.set("value","Close");i.show();g.hide()}else{e.show();d.set("value","Cancel");i.hide();g.show()}this.updatePulldown()}},updatePulldown:function(){var b=this.get("optionArray"),a=this.get("addDialogNode").one("select");if(!a){return}a.setContent("");Y.each(b,function(c){var d='<option value="{val}">{text}</option>';a.appendChild(Y.Node.create(Y.substitute(d,{val:c[0],text:c[1]})))})},createRemoveDialog:function(){var c,b=this.get("containerNode"),f=this.get("removeDialogNode"),d=f.one("input, select").get("form"),e=this.get("removeMethod"),g=this.get("respMethod"),a=this.get("liveStat"),h=this.get("objectName");f.addClass(this.getClassName("dialog-contents"));c=RBT.VE.createActionDialog({srcNode:f,alignNode:b,actionButtonText:"Remove "+h,actionFunc:RBT.VE.ajaxSubmit,actionArgs:Y.Array({formEl:d,reqMethod:e,respMethod:g,liveStat:a,liveStatMsg:"Removing "+h+"...",onSuccess:Y.bind(this.refresh,this)})});this.set("removeDialog",c)},showRemoveDialog:function(e){var d=this.get("removeDialogNode"),c=d.one("."+this.getClassName("remove-input")),b=d.one("."+this.getClassName("remove-text")),a=this.get("removeDialog");if(c){c.set("value",e[0])}if(b){b.set("text",e[1])}RBT.VE.showActionDialog(a)}});RBT.VE.SnapSchedule=function(){RBT.VE.SnapSchedule.superclass.constructor.apply(this,arguments)};RBT.VE.SnapSchedule.NAME="snapschedule";RBT.VE.SnapSchedule.CSS_PREFIX="rbt-snapschedule";RBT.VE.SnapSchedule.ATTRS={containerNode:{setter:Y.one},isHorizontal:{value:false,validator:Y.Lang.isBoolean},daysOfWeek:{value:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],readOnly:true}};Y.extend(RBT.VE.SnapSchedule,Y.Base,{getClassName:function(){return RBT.VE.SnapSchedule.CSS_PREFIX+"-"+Y.Array(arguments).join("-")},render:function(d){var b,e,a=this.get("containerNode"),c=this.get("isHorizontal");d={weekly:{day:parseInt(d.weekly.day,10),hour:parseInt(d.weekly.hour,10)},daily:{days:Y.Array.map(d.daily.days,function(f){return parseInt(f,10)}),hour:parseInt(d.daily.hour,10)},hourly:{hours:Y.Array.map(d.hourly.hours,function(f){return parseInt(f,10)})}};if(c){e=this.renderDaysHorizontal(d)}else{e=this.renderDaysVertical(d)}b='<table class="{tableClass}">{rowsHtml}</table>';b=Y.substitute(b,{tableClass:this.getClassName("table")+" "+this.getClassName(c?"horiz":"vert"),rowsHtml:e});a.setContent(b);return this},renderDaysVertical:function(e){var a,f="",c=this.get("daysOfWeek"),b=this.getClassName("day","header"),d=this.getClassName("hour","mark","vert");f+='<td class="'+d+'" rowspan="25">  <div class="'+d+'">12AM</div>  <div class="'+d+'">12PM</div></td>';Y.each(c,function(g){f+='<td class="'+b+'">'+g+"</td>"});f="<tr>"+f+"</tr>";for(a=0;a<24;a++){f+="<tr>";Y.each(c,function(g,h){f+="<td "+this.getTdAttrs(e,h,a)+" ></td>"},this);f+="</tr>"}return f},renderDaysHorizontal:function(e){var f="",c=this.get("daysOfWeek"),b=this.getClassName("day","header"),a=this.getClassName("day","footer"),d=this.getClassName("hour","mark","horiz");f+="<tr>";Y.each(c,function(g){f+='<td colspan="24" class="'+b+'">'+g+"</td>"},this);f+="</tr>";f+="<tr>";Y.each(c,function(g,i){var h;for(h=0;h<24;h++){f+="<td "+this.getTdAttrs(e,i,h)+" ></td>"}},this);f+="</tr>";f+="<tr>";Y.each(c,function(){f+='<td colspan="24" class="'+a+'">  <span class="'+d+'">12AM</span>  <span class="'+d+'">12PM</span></td>'},this);f+="</tr>";return f},getTdAttrs:function(f,d,a){var c=this.getClassName("hour",a.toString()),b=this.get("daysOfWeek"),e=[];if(f.weekly.day===d&&f.weekly.hour===a){c+=" "+this.getClassName("weekly","active");e.push("Every week on "+b[d]+" at "+this.formatHour(a))}if(f.daily.hour===a&&Y.Array.indexOf(f.daily.days,d)!==-1){c+=" "+this.getClassName("daily","active");e.push("Every "+b[d]+" at "+this.formatHour(a))}if(Y.Array.indexOf(f.hourly.hours,a)!==-1){c+=" "+this.getClassName("hourly","active");e.push("Every day at "+this.formatHour(a))}return'class="'+c+'" title="'+e.join(", ")+'"'},formatHour:function(a){var b=a<=11?"AM":"PM";if(a===0||a===12){a=12}else{a=a%12}return a.toString()+b}});var RBT_SH={};function DomainHealthCheckWidget(b,c,a){this.actionName=b;this.uniqueID=c;this.parameterList=a;this.countUpBaseTimestamp=-1;this.testStatus=""}DomainHealthCheckWidget.prototype.setLastRunParams=function(j){var a=j.split("#");var b={};if(this.parameterList.length==0){return}for(var e=0;e<a.length;e++){var d=a[e].split("=");if(d.length==2){var h=d[0];var g=d[1];b[h]=g;if(arrayContains(this.parameterList,h)){if(h=="domain"||h=="realm"){g=g.toLowerCase()}setFormValue($(this.uniqueID),h,g)}else{if(h=="conf_type"){g=g.split(",");for(var e=0;e<g.length;e++){setFormValue($(this.uniqueID),g[e],true)}}}}}for(var e=0;e<this.parameterList.length;e++){if(this.parameterList[e]=="group-username"){var c=b.domain;var f=b.shortdom;if(c!=undefined&&c.length){setFormValue($(this.uniqueID),"group-username-options","domain");setFormValue($(this.uniqueID),"group-username-domain",c);setFormValue($(this.uniqueID),"group-username-shortdom","")}else{if(f!=undefined&&f.length){setFormValue($(this.uniqueID),"group-username-options","shortdom");setFormValue($(this.uniqueID),"group-username-domain","");setFormValue($(this.uniqueID),"group-username-shortdom",f)}else{setFormValue($(this.uniqueID),"group-username-options","username");setFormValue($(this.uniqueID),"group-username-domain","");setFormValue($(this.uniqueID),"group-username-shortdom","")}}}}};DomainHealthCheckWidget.prototype.updateCountUpTimer=function(){var a=$("countUpTimer_"+this.uniqueID);var c=$("lastRun_"+this.uniqueID);if(this.countUpBaseTimestamp>0){var b=new Date();var d=(b.getTime()-this.countUpBaseTimestamp)/1000;setElementText(a,englishTimeInterval(d,"N/A","ago"));setElementText(c,this.countUpBaseTimestamp.toLocaleString())}else{setElementText(a,"");setElementText(c,"")}};DomainHealthCheckWidget.prototype.statusReturned=function(b){var f=$("status_"+this.uniqueID,true);var e=$("statusInfo_"+this.uniqueID,true);if(f.hasClass("statusSuccess")){f.removeClass("statusSuccess")}if(f.hasClass("statusFailure")){f.removeClass("statusFailure")}if(e.hasClass("domainHealth_statusSuccess")){e.removeClass("domainHealth_statusSuccess")}if(e.hasClass("statusFailure")){e.removeClass("statusFailure")}switch(b.status){case"SUCCESS":setElementText(f,"Success");f.addClass("statusSuccess");setElementText(e,"S");e.addClass("domainHealth_statusSuccess");break;case"NOT STARTED":setElementText(f,"--");setElementText(e,"--");break;case"FAILED":setElementText(f,"Failed");f.addClass("statusFailure");setElementText(e,"F");e.addClass("statusFailure");break;case"IN PROGRESS":setElementText(f,"In Progress");setElementText(e,"IP");break}var c=new Date(b.timestamp*1000);this.testStatus=b.status;if(this.testStatus=="IN PROGRESS"||this.testStatus=="NOT STARTED"){this.countUpBaseTimestamp=-1;this.updateCountUpTimer()}else{this.countUpBaseTimestamp=c;this.updateCountUpTimer()}this.setLastRunParams(b.lastRunParams);var a=parseInt(b.logLines);if(a==0){enableElements("logNone_"+this.uniqueID,true);enableElements("logSome_"+this.uniqueID,"hide")}else{enableElements("logNone_"+this.uniqueID,"hide");enableElements("logSome_"+this.uniqueID,true);setElementText("open_expander_"+this.uniqueID,"Show Logs ("+a+" Lines)");setElementText("close_expander_"+this.uniqueID,"Hide Logs ("+a+" Lines)")}Y.one("#logData_"+this.uniqueID+" tbody").get("childNodes").each(function(g){g.remove(true)});var d=Y.Node.create(b.log);Y.one("#logData_"+this.uniqueID+" tbody").appendChild(d)};function enableClosed(a){enableElements("logClosed_"+a,true);enableElements("logOpened_"+a,"hide")}function enableOpened(a){enableElements("logClosed_"+a,"hide");enableElements("logOpened_"+a,true)}DomainHealthCheckWidget.prototype.updateStats=function(){var a=this;RBT.rpc({url:"/mgmt/jsondata?p=domainActionStatus",fields:{actionName:a.actionName},successFn:function(c){a.statusReturned(c);RBT.Validator.validatePage();var b=$("actionControls_"+a.uniqueID);if(a.testStatus=="IN PROGRESS"){enableElements(b,false);a.countUpBaseTimestamp=-1;a.updateCountUpTimer();setTimeout(function(){a.updateStats()},3000)}else{enableElements(b,true);a.updateCountUpTimer()}},errorFn:function(b){}});return false};DomainHealthCheckWidget.prototype.sendDomainAction=function(j){var c=newAjaxRequest("/mgmt/xmldata?p=domainTestControl");setReadyStateChangeFunc(c,function(){if(c.responseXML.documentElement.firstChild.nodeName!="okay"){new RBT.Dialog({alignNode:Y.one("[name="+j+"]"),affinity:RBT.Dialog.AFFINITY_SW,content:c.responseText}).render()}});if(this.parameterList.length!=0){var a="&";for(var d=0;d<this.parameterList.length;d++){var g=this.parameterList[d];if(g=="group-username"){var h=getFormValue(this.uniqueID,"group-username-options");if(h=="domain"){var b=getFormValue(this.uniqueID,"group-username-domain").trim();a+="domain="+escape(b)+"&"}else{if(h=="shortdom"){var e=getFormValue(this.uniqueID,"group-username-shortdom").trim();a+="shortdom="+escape(e)+"&"}}}else{var f=getFormValue(this.uniqueID,g);if(typeof(f)!="boolean"){f=f.trim()}f=escape(f);a+=g+"="+f+"&"}}c.send("testName="+escape(this.actionName)+a)}else{c.send("testName="+escape(this.actionName))}this.updateStats();return false};DomainHealthCheckWidget.prototype.initialUpdateStats=function(){var a=this;enableClosed(a.uniqueID);Y.on("domready",function(){a.updateStats();a.resetCountUpTimer()})};DomainHealthCheckWidget.prototype.resetCountUpTimer=function(){var a=this;this.updateCountUpTimer();Y.later(10000,null,function(){a.resetCountUpTimer()})};domainAuthServerName=function(a){if(a.length>15){throw"Server Name must be less than 16 characters."}if(/[\\/:*?"<>|. ]/.test(a)){throw"Invalid Server Name."}};serverList=function(b){var c=b.split(",");for(var a=0;a<c.length;a++){domainAuthServerName(c[a].trim())}};