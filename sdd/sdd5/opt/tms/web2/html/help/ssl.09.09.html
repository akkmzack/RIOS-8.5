<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Setting Advanced SSL Options</title>
    <link rel="StyleSheet" href="css/ssl.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
  </head>
  <body onload="WWHUpdate();" onunload="WWHUnload();" onkeydown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onkeypress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onkeyup="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <a class="WebWorks_Breadcrumb_Link" href="ssl.09.01.html#222812">Chapter 7	Configuring SSL and a Secure Inner Channel</a> : <a class="WebWorks_Breadcrumb_Link" href="setupServiceProtocolsSSLAdvanced.html#222812">Configuring Advanced and SSL Cipher Settings </a> : Setting Advanced SSL Options</div>
    <hr align="left" />
    <blockquote>
      <div class="Heading2Topic"><a name="222812">Setting Advanced SSL Options</a></div>
      <div class="Body"><a name="222816">You can synchronize the SSL chain certificate configuration, configure Steelhead Mobile for SSL, improve </a>performance for SSL connection establishment, and enable client certificate authentication in the Configure &gt; Optimization &gt; Advanced Settings page. </div>
      <div class="HeadingProcedure"><a name="237329">To set advanced SSL options</a></div>
      <div class="Step1_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step1_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step1_inner"><a name="222817">Choose Configure &gt; Optimization &gt; Advanced Settings to display the Advanced Settings page.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="222822"> Complete the configuration as described in this table.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <table class="RegularTable" style="text-align: left; width: 468.87552pt" cellspacing="0" summary="">
        <caption></caption>
        <tr>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 104.68728pt">
            <div class="CellHeading"><a name="337350">Control</a></div>
          </td>
          <td style="background-color: #ADBDF2; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 364.18824pt">
            <div class="CellHeading"><a name="337352">Description</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337354">Enable SSL Server </a>Certificate Chain Discovery</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337359">Synchronizes the chain certificate configuration on the server-side Steelhead appliance </a>with the chain certificate configuration on the back-end server. The synchronization occurs after a handshake fails between the client-side and server-side Steelhead appliance. By default, this option is disabled.</div>
            <div class="CellBody"><a name="337363">Enable this option when you replace an existing chain certificate on the back-end server </a>with a new chain to ensure that the certificate chain remains in sync on both the server-side Steelhead appliance and the back-end server.</div>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="337367"> This option never replaces the server certificate. It updates the chain containing the </a>intermediate certificates and the root certificate in the client context. </div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337369">Steelhead Mobile </a>Security Mode</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337375">On the server-side Steelhead appliance, select one of these security modes:</a></div>
            <li class="CellBullet"><span style="font-weight: bold"><a name="337380">High Security Mode</a></span><span class="Bold" style="font-weight: normal"> - </span>Enforces the advanced SSL protocol on the Steelhead Mobile Clients for increased security. </li>
            <li class="CellBullet"><span style="font-weight: bold"><a name="337386">Mixed Security Mode</a></span><span class="Bold" style="font-weight: normal"> - </span>Allows Steelhead Mobile clients to run in any SSL mode. This mode is required to optimize with mobile clients running on VMware Fusion.</li>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="337393"> This option does not affect Steelhead appliance-to-Steelhead appliance operation.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337396">Enable Distributed SSL </a>Termination</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337402">Enables reuse of the original session on a client-side Steelhead appliance when the client </a>reconnects to an SSL server. Reusing the session provides two benefits: it lessens the CPU load because it eliminates expensive asymmetric key operations and it shortens the key negotiation process by avoiding WAN roundtrips to the server. By default, this option is enabled. Both the client-side and server-side Steelhead appliances must be configured to optimize SSL traffic.</div>
            <li class="CellBullet"><span style="font-weight: bold"><a name="337408">Timeout</a></span><span class="Bold" style="font-weight: normal"> - </span>Specify the amount of time the client can reuse a session with an SSL server after the initial connection ends. The range is 6 minutes to 24 hours. The default value is 10 hours. </li>
            <div class="CellBody"><a name="337409">Enabling this option requires an optimization service restart.</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337412">Enable Client </a>Certificate Support</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337414">Enables acceleration of SSL traffic to those SSL servers that authenticate SSL clients. The </a>SSL server verifies the SSL client certificate. In the client authentication SSL handshake, each client has a unique client certificate and the SSL server, in most cases, maintains the state that is specific to each client when answering the client's requests. The SSL server must receive exactly the same certificate that is originally issued for a client on all the connections between the client and the server. Typically the client's unique certificate and private key are stored on a smart card, such as a Common Access Card (CAC), or on a similar location that is inaccessible to other devices on the network. </div>
            <div class="CellBody"><a name="337415">By default, client authentication is disabled.</a></div>
            <div class="CellBody"><a name="337419">Enabling the client authentication feature allows Steelhead appliances to compute the </a>encryption key while the SSL server continues to authenticate the original SSL client exactly as it would without the Steelhead appliances. The server-side Steelhead appliance observes the SSL handshake messages as they go back and forth. With access to the SSL server's private key, the Steelhead appliance computes the session key exactly as the SSL server does. The SSL server continues to perform the actual verification of the client, so any dependencies on the uniqueness of the client certificate for correct operation of the application are met. Because the Steelhead appliance does not modify any of the certificates (or the handshake messages) exchanged between the client and the server, there is no change to their trust model. The client and server continue to trust the same set of certificate authorities as they did without the Steelhead appliances accelerating their traffic. </div>
            <div class="CellNote">
              <span class="Bold">Note: </span><a name="337435">If the data center has a mixed environment with a few SSL servers that authenticate </a>clients along with those that do not authenticate clients, Riverbed recommends enabling client authentication. </div>
            <div class="CellHeading"><a name="337439">Requirements</a></div>
            <li class="CellBullet"><a name="337446">Both the client-side and the server-side Steelhead appliance must be running RiOS v6.5 </a>or later.</li>
            <li class="CellBullet"><a name="337450">Enable client certificate support on the server-side Steelhead appliance.</a></li>
            <li class="CellBullet"><a name="337454">The server-side Steelhead appliance must have access to the exact private key used by </a>the SSL server.</li>
            <li class="CellBullet"><a name="337455">The SSL server must be configured to ask for client certificates.</a></li>
            <li class="CellBullet"><a name="337459">The Steelhead appliance must have a compatible cipher chosen by the server.</a></li>
            <li class="CellBullet"><a name="337460">SSL sessions that reuse previous secrets that are unknown to the Steelhead appliance </a>cannot be decrypted.</li>
            <li class="CellBullet"><a name="337461">Client-side certificates with renegotiation handshakes are not supported.</a></li>
            <li class="CellBullet"><a name="337462">Client certificate supports the RSA key exchange only. It does not support the Diffie-</a>Hellman key exchange.</li>
            <div class="CellHeading"><a name="337463">Basic Steps</a></div>
            <div class="CellBody"><a name="337464">The basic steps to enable client authentication are:</a></div>
            <div class="CellBody"><a name="337465">1. Perform the basic steps to enable SSL optimization (described in Configuring SSL </a>Server Certificates and Certificate Authorities).</div>
            <div class="CellBody"><a name="337469">2. On the server-side Steelhead appliance, choose Configure &gt; Optimization &gt; Advanced </a>Settings, select Enable Client Certificate Support, and click <span style="font-weight: bold">Apply</span>. </div>
            <div class="CellBody"><a name="337470">3. Choose Configure &gt; Optimization&gt; SSL Main Settings, import the private key and </a>certificate used by the SSL server to the server-side Steelhead appliance, and click <span style="font-weight: bold">Save</span> to save the configuration. You do not need to restart the optimization service.</div>
            <div class="CellHeading"><a name="337474">Verification</a></div>
            <div class="CellBody"><a name="337478">To verify client authentication, on the server-side Steelhead appliance, check the </a>Discovered Server (Optimizable) table in the Configure &gt; Optimization &gt; SSL Main Settings page. Optimizable servers that are using client authentication appear as optimizable. For servers that are not using client authentication, the server appears in the Discovered Server (bypassed, not optimizable) table with the reason &#8220;No proxy certificate configured for the server.&#8221;</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337480">Enable SSL Proxy </a>Support</div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337485">Enable on both the client-side and server-side Steelhead appliances when clients are </a>communicating with SSL to a server through one or more proxies. Proxy support allows the Steelhead appliance to optimize traffic to a proxy server. </div>
            <div class="CellBody"><a name="337492">SSL traffic communication with a proxy initiates with an HTTP CONNECT message. The </a>Steelhead appliance recognizes the HTTP CONNECT message in the connection, extracts the hostname, and then optimizes the SSL connection that follows into the proxy state machine (expecting an SSL handshake following the CONNECT message). </div>
            <div class="CellBody"><a name="337499">In addition to enabling this feature on both Steelhead appliances, you must:</a></div>
            <li class="CellBullet"><a name="337503">Create an in-path rule on the client-side Steelhead appliance to identify the proxy </a>server IP address and port number. Select the SSL preoptimization policy for the rule.</li>
            <li class="CellBullet"><a name="337506">SSL optimization must be enabled on both the client-side and server-side Steelhead </a>appliances.</li>
            <li class="CellBullet"><a name="337511">Both the client-side and server-side Steelhead appliances must be running RiOS v7.0 or </a>later.</li>
            <li class="CellBullet"><a name="337515">Restart the optimization service on both Steelhead appliances.</a></li>
            <div class="CellBody"><a name="337516">By default, SSL proxy support is disabled.</a></div>
            <div class="CellBody"><a name="337520">When the Steelhead appliance connects, the proxy servers appear in the SSL Main </a>Settings page on the server-side Steelhead appliance in the Discovered SSL Server (Optimizable) list. The same IP address appears on multiple lines, followed by the word &#8220;proxy.&#8221; The hostname of the back-end server appears in the Server Common Name field. All subsequent connections to the proxy servers are optimized.</div>
            <div class="CellBody"><a name="337524">When an error occurs, the proxy servers appear in the SSL Main Settings page on the </a>server-side Steelhead appliance in the Discovered Servers (bypassed, not optimized) list. The same IP address appears on multiple lines, followed by the word &#8220;proxy.&#8221; The hostname of the back-end server appears in the Server Common Name field. All subsequent connections to the servers are not optimized.</div>
            <div class="CellBody"><a name="337528">If you disable proxy support, you must delete the corresponding in-path rule and restart </a>the optimization service.</div>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337531">Enable Midsession SSL</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337537">Enable on both the client-side and server-side Steelhead appliances when there is a </a>delayed start to the Transport Layer Security (TLS) handshake because clients are transitioning into SSL after the initial handshake occurs. This feature optimizes connections that transition into SSL.</div>
            <div class="CellBody"><a name="337540">Client examples include SMTP/POP/IMAP-over-TLS and Microsoft .NET Windows </a>Communication Foundation (WCF)-based TLS applications. This feature also enables SSL communication with protocols like Exchange-Hub to Exchange-Hub replications (for example, the SMTP-over-TLS protocol). </div>
            <div class="CellBody"><a name="337543">For details on SMTP over TLS Optimization, see the </a><span class="book_title">Steelhead Appliance Deployment Guide </span><span class="book_title">- Protocols</span>.</div>
            <div class="CellBody"><a name="337548">The Steelhead appliance looks for an SSL handshake for the life of the connection, and </a>then optimizes the SSL connection that follows (except for an SSL handshake following the HTTP CONNECT message, in which case the SSL proxy support feature needs to be enabled). </div>
            <div class="CellBody"><a name="337552">After enabling this feature on both Steelhead appliances you must restart the </a>optimization service.</div>
            <div class="CellBody"><a name="337556">When the Steelhead appliance connects, the servers appear in the SSL Main Settings page </a>on the server-side Steelhead appliance in the Discovered SSL Server (Optimizable) list. All subsequent connections to the servers are optimized.</div>
            <div class="CellBody"><a name="337560">By default, midsession SSL is disabled.</a></div>
            <div class="CellBody"><a name="337561">Requirements:</a></div>
            <li class="CellBullet"><a name="337565">Both the client-side and server-side Steelhead appliances must be running RiOS v7.0 or </a>later.</li>
            <li class="CellBullet"><a name="337566">The SSL client must be the same as the TCP client.</a></li>
            <li class="CellBullet"><a name="337567">SSL messages cannot be wrapped with any other non-SSL or non-TCP protocol </a>headers or footers.</li>
            <li class="CellBullet"><a name="337570">SSL optimization must be enabled on both the client-side and server-side Steelhead </a>appliances.</li>
          </td>
        </tr>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337573">Enable SNI</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top">
            <div class="CellBody"><a name="337578">Enable on the server-side Steelhead appliance while using name-based virtual hosts with </a>SSL. Server name indication (SNI) is a transport layer security extension to the SSL protocol. With SNI, the first SSL client hello handshake message sent to the HTTPS server includes the requested virtual hostname to which the client is connecting. Because the server is aware of the hostname, it returns a host-specific security certificate. </div>
            <div class="CellBody"><a name="337579">Without SNI, an HTTPS server returns a default certificate that satisfies hostnames for all </a>virtual hosts. The SSL connection setup uses the default virtual host configuration for the address where the connection was received. Browser messages warn that certificates have the wrong hostname. </div>
            <div class="CellBody"><a name="337583">With SNI enabled, RiOS provides the hostname. This enables the server to determine the </a>correct named virtual host for the request and set up the connection accordingly from the start. </div>
            <div class="CellBody"><a name="337584">The browser validates the certificate names against the requested URL, and the server-</a>side Steelhead appliance verifies that the selected proxy certificate is compatible with the client hostname. This ensures that the browser does not reject the proxy certificate for the server-side Steelhead appliance.</div>
            <div class="CellBody"><a name="337591">If SNI provides a hostname that does not exactly match the common name or any of the </a>subject alternate names for the certificate on the server-side Steelhead appliance, the system determines that a valid certificate is not present and bypasses that hostname. </div>
            <div class="CellBody"><a name="337598">No configuration is necessary on the client-side Steelhead appliance.</a></div>
            <div class="CellBody"><a name="337599">The client browser must also support SNI.</a></div>
          </td>
        </tr>
      </table>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="222885">	</a>			Click <span class="Bold">Apply</span> to apply your settings.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="222886">Click </a><span class="Bold">Save </span>to save your settings permanently.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Step_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="Step_inner" style="width: 16.128pt; white-space: nowrap;">
                <span class="Bold">5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step_inner"><a name="222890">If you have enabled Client Side Session Reuse, SSL Proxy Support, Midsession SSL, or SNI, you must </a>restart the optimization service. For details, see <span class="xref"><a href="javascript:WWHClickedPopup('Management_Console_Online_Help_v8.5', 'setupAppliance_service.html#281155', '');" title="Starting and Stopping the Optimization Service">Starting and Stopping the Optimization Service</a></span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Note">
        <span class="Bold">Note: </span><a name="222899">For details about Steelhead Mobile security mode and client-side session reuse, see the </a><span class="book_title">Steelhead Appliance </span><span class="book_title">Deployment Guide - Protocols</span>.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <hr align="left" />
    <table align="right">
      <tr>
        <td class="WebWorks_Company_Logo_Bottom">
          <a href="http://riverbed.com" target="external_window"><img src="riverbed_logo_without_tagline.jpg" border="0" /></a>
        </td>
      </tr>
    </table>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>